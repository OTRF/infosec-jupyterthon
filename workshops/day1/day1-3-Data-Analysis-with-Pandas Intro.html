
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Workshop 1.3: Basics of Data Analysis with Pandas</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script src="../../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://infosecjupyterthon.com/workshops/day1/day1-3-Data-Analysis-with-Pandas Intro.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Day 2" href="../day2/intro.html" />
    <link rel="prev" title="Workshop 1.2: Acquiring Data" href="day1-2-Acquiring-data.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint">💖 The InfoSec Jupyterthon is happening again! December 2nd and 3rd, 2022 🚀</div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../conduct.html">
   Code of Conduct
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../collaborators/intro.html">
   Collaborators
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../collaborators/Roberto-Rodriguez.html">
     Roberto Rodriguez
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../collaborators/Chi-Nguyen.html">
     Chi Nguyen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../collaborators/Ian-Hellen.html">
     Ian Hellen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../collaborators/Joyce-Bacic.html">
     Joyce Bacic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../collaborators/Ashwin-Patil.html">
     Ashwin Patil
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../collaborators/Thomas-Roccia.html">
     Thomas Roccia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../collaborators/Pete-Bryan.html">
     Pete Bryan
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  2022 Edition
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../2022/agenda.html">
   agenda
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Workshops
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Day 1
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="day1-1-Jupyter-Introduction.html">
     Workshop 1.1:
     <font color="peru">
      Jupyter Notebooks Introduction
     </font>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="day1-2-Acquiring-data.html">
     Workshop 1.2:
     <font color="peru">
      Acquiring Data
     </font>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Workshop 1.3:
     <font color="peru">
      Basics of Data Analysis with Pandas
     </font>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../day2/intro.html">
   Day 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../day2/day2-1-Jupyter-advanced-topics.html">
     Workshop 2.1:
     <font color="peru">
      Jupyter Notebooks Advanced
     </font>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../day2/day2-1-R-demo-notebook.html">
     Workshop 2.1:
     <font color="peru">
      R Demo Notebook
     </font>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../day2/day2-2-Visualization.html">
     Workshop 2.2:
     <font color="peru">
      Visualization in Jupyter Notebooks
     </font>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../day2/day2-3-Advanced-pandas.html">
     Workshop 2.3:
     <font color="peru">
      Advanced Pandas
     </font>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../day2/day2-4-MSTICPy.html">
     Workshop 2.4:
     <font color="peru">
      MSTICPy
     </font>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/OTRF/infosec-jupyterthon/master?urlpath=lab/tree/docs/workshops/day1/day1-3-Data-Analysis-with-Pandas Intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/OTRF/infosec-jupyterthon/edit/master/docs/workshops/day1/day1-3-Data-Analysis-with-Pandas Intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/workshops/day1/day1-3-Data-Analysis-with-Pandas Intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Workshop 1.3:
   <font color="peru">
    Basics of Data Analysis with Pandas
   </font>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-import-pandas-importing-the-pandas-library-a">
   <a name="import-pandas" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Importing the Pandas Library
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-dataframe-representing-data-in-an-organized-way-dataframe-a">
   <a name="dataframe" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Representing data in an Organized way: Dataframe
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pandas-structures">
     Pandas Structures
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#series">
       Series
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dataframe">
       DataFrame
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-data-as-a-pandas-dataframe">
     Importing data as a Pandas DataFrame
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#importing-json-files">
       Importing
       <strong>
        JSON
       </strong>
       files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#importing-csv-files">
       Importing
       <strong>
        CSV
       </strong>
       files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#notes-on-csv-files">
       Notes on CSV Files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#importing-pickle-files">
       Importing
       <strong>
        PICKLE
       </strong>
       files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#importing-remote-files">
       Importing
       <strong>
        Remote Files
       </strong>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-interacting-interacting-with-dataframes-a">
   <a name="interacting" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Interacting with DataFrames
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#size-shape-of-a-dataframe">
     Size/Shape of a DataFrame
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#single-row-of-dataframe-series">
       Single row of DataFrame == Series
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#intersection-of-a-row-and-column-is-a-simple-type-the-cell-content">
       Intersection of a row and column is a simple type - the cell content
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selecting-columns">
     Selecting Columns
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-the-columns-property-to-get-the-column-names">
       Use the columns property to get the column names
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indexes-brief-introduction">
     Indexes - brief introduction
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#setting-another-column-as-index">
       Setting another column as index
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-individual-cell-values">
     Accessing individual (“cell”) values
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-single-value">
       A single value
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#retrieving-values-from-a-pandas-series">
       Retrieving values from a pandas series
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pandas-i-o-functions">
     pandas I/O functions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dataframe-input-functions">
       DataFrame input functions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dataframe-output-functions">
       DataFrame output functions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#export-to-excel-typically-need-openpyxl-installed-and-excel-or-similar">
       Export to Excel - typically need
       <code class="docutils literal notranslate">
        <span class="pre">
         openpyxl
        </span>
       </code>
       installed (and Excel or similar)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-json-vs-json-normalize">
       read_json vs json_normalize
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-html-to-read-tables-from-web-pages">
       read_html to read tables from web pages
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-selecting-selecting-searching-a">
   <a name="selecting" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Selecting/Searching
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specific-row-or-col-by-number">
     Specific row (or col) by number
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#you-can-go-full-numpy-and-use-iloc-with-int-indexing">
       You can go full numpy and use
       <code class="docutils literal notranslate">
        <span class="pre">
         iloc
        </span>
       </code>
       with int indexing
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-by-content-boolean-indexing">
     Select by content - “Boolean indexing”
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#basic-operators">
       Basic operators
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-boolean-result-of-expression-to-filter-dataframe">
       Use boolean result of expression to filter DataFrame
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#note">
       Note
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-operators-with-boolean-indexing">
     Other operators with boolean indexing
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pandas-supports-string-functions-but">
       Pandas supports string functions - but
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#we-need-to-tell-pandas-to-apply-string-operation-as-a-vector-function-to-the-series">
       We need to tell pandas to apply string operation as a
       <em>
        vector function
       </em>
       to the series
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiple-conditions">
     Multiple conditions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#without-parentheses-have-higher-precedence">
       Without parentheses -
       <code class="docutils literal notranslate">
        <span class="pre">
         &amp;,
        </span>
        <span class="pre">
         |,
        </span>
        <span class="pre">
         ~
        </span>
       </code>
       have higher precedence
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boolean-indexes-are-pandas-series-you-can-save-and-re-use">
       Boolean indexes are
       <strong>
        Pandas series
       </strong>
       - you can save and re-use
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#isin-operator-function">
     <code class="docutils literal notranslate">
      <span class="pre">
       isin
      </span>
     </code>
     operator/function
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pandas-query-function">
     pandas
     <code class="docutils literal notranslate">
      <span class="pre">
       query
      </span>
     </code>
     function
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#combing-column-select-and-filter">
       Combing Column Select and filter
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-sorting-sorting-and-removing-duplicates-a">
   <a name="sorting" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Sorting and removing duplicates
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-grouping-grouping-and-aggregation-a">
   <a name="grouping" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Grouping and Aggregation
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#you-need-an-aggregator-or-iterator-make-use-of-grouping">
     You need an aggregator (or iterator) make use of grouping
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iterating-over-groups-groupby-returns-an-iterable">
     Iterating over groups -
     <code class="docutils literal notranslate">
      <span class="pre">
       groupby
      </span>
     </code>
     returns an iterable
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grouping-with-multiple-aggregation-functions">
     Grouping with Multiple aggregation functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grouping-with-multiple-columns">
     Grouping with multiple columns
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-pd-grouper-to-group-by-time-interval">
     Using pd.Grouper to group by time interval
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-adding-columns-adding-and-removing-columns-a">
   <a name="adding-columns" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Adding and removing columns
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assign-function">
     <code class="docutils literal notranslate">
      <span class="pre">
       assign
      </span>
     </code>
     function
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#drop-columns">
       Drop columns
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-other-quick-ways-of-filtering-out-in-columns">
     Some other quick ways of filtering out (in) columns
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-simple-joins-simple-joins-a">
   <a name="simple-joins" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Simple Joins
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concatenating-dfs">
     Concatenating DFs
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#joining-rows">
       Joining rows
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ignore-index-true-causes-python-to-regenerate-a-new-index">
         <code class="docutils literal notranslate">
          <span class="pre">
           ignore_index=True
          </span>
         </code>
         causes Python to regenerate a new index
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#joining-columns-horizontal">
     Joining columns (horizontal)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-stats-101-statistics-101-with-pandas-a">
   <a name="stats-101" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Statistics 101 with Pandas
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-types">
     Data Types
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-data">
       <strong>
        Numerical
       </strong>
       data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#categorical-data">
       <strong>
        Categorical
       </strong>
       data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#descriptive-analysis-for-categorical-data">
     Descriptive Analysis for Categorical data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#categorical-data-types-in-pandas">
       <strong>
        Categorical data types
       </strong>
       in Pandas
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#describe-method">
       <strong>
        Describe Method
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#frequency-of-values">
       <strong>
        Frequency of Values
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#central-tendency">
       <strong>
        Central Tendency
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#correlation">
       <strong>
        Correlation
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#descriptive-analysis-for-numerical-data">
     Descriptive Analysis for Numerical data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-data-type-in-pandas">
       <strong>
        Numerical data type
       </strong>
       in Pandas
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       <strong>
        Describe Method
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       <strong>
        Frequency of Values
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       <strong>
        Central Tendency
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#shape-of-distribution-of-frequencies">
       <strong>
        Shape of Distribution of Frequencies
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variability">
       <strong>
        Variability
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       <strong>
        Correlation
       </strong>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#end-of-session">
   End of Session
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#font-color-peru-break-5-minutes-font">
   <font color="peru">
    Break: 5 Minutes
   </font>
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Workshop 1.3: <font color=peru>Basics of Data Analysis with Pandas</font></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Workshop 1.3:
   <font color="peru">
    Basics of Data Analysis with Pandas
   </font>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-import-pandas-importing-the-pandas-library-a">
   <a name="import-pandas" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Importing the Pandas Library
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-dataframe-representing-data-in-an-organized-way-dataframe-a">
   <a name="dataframe" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Representing data in an Organized way: Dataframe
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pandas-structures">
     Pandas Structures
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#series">
       Series
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dataframe">
       DataFrame
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-data-as-a-pandas-dataframe">
     Importing data as a Pandas DataFrame
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#importing-json-files">
       Importing
       <strong>
        JSON
       </strong>
       files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#importing-csv-files">
       Importing
       <strong>
        CSV
       </strong>
       files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#notes-on-csv-files">
       Notes on CSV Files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#importing-pickle-files">
       Importing
       <strong>
        PICKLE
       </strong>
       files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#importing-remote-files">
       Importing
       <strong>
        Remote Files
       </strong>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-interacting-interacting-with-dataframes-a">
   <a name="interacting" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Interacting with DataFrames
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#size-shape-of-a-dataframe">
     Size/Shape of a DataFrame
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#single-row-of-dataframe-series">
       Single row of DataFrame == Series
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#intersection-of-a-row-and-column-is-a-simple-type-the-cell-content">
       Intersection of a row and column is a simple type - the cell content
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selecting-columns">
     Selecting Columns
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-the-columns-property-to-get-the-column-names">
       Use the columns property to get the column names
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indexes-brief-introduction">
     Indexes - brief introduction
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#setting-another-column-as-index">
       Setting another column as index
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-individual-cell-values">
     Accessing individual (“cell”) values
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-single-value">
       A single value
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#retrieving-values-from-a-pandas-series">
       Retrieving values from a pandas series
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pandas-i-o-functions">
     pandas I/O functions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dataframe-input-functions">
       DataFrame input functions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dataframe-output-functions">
       DataFrame output functions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#export-to-excel-typically-need-openpyxl-installed-and-excel-or-similar">
       Export to Excel - typically need
       <code class="docutils literal notranslate">
        <span class="pre">
         openpyxl
        </span>
       </code>
       installed (and Excel or similar)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-json-vs-json-normalize">
       read_json vs json_normalize
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-html-to-read-tables-from-web-pages">
       read_html to read tables from web pages
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-selecting-selecting-searching-a">
   <a name="selecting" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Selecting/Searching
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specific-row-or-col-by-number">
     Specific row (or col) by number
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#you-can-go-full-numpy-and-use-iloc-with-int-indexing">
       You can go full numpy and use
       <code class="docutils literal notranslate">
        <span class="pre">
         iloc
        </span>
       </code>
       with int indexing
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-by-content-boolean-indexing">
     Select by content - “Boolean indexing”
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#basic-operators">
       Basic operators
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-boolean-result-of-expression-to-filter-dataframe">
       Use boolean result of expression to filter DataFrame
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#note">
       Note
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-operators-with-boolean-indexing">
     Other operators with boolean indexing
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pandas-supports-string-functions-but">
       Pandas supports string functions - but
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#we-need-to-tell-pandas-to-apply-string-operation-as-a-vector-function-to-the-series">
       We need to tell pandas to apply string operation as a
       <em>
        vector function
       </em>
       to the series
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiple-conditions">
     Multiple conditions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#without-parentheses-have-higher-precedence">
       Without parentheses -
       <code class="docutils literal notranslate">
        <span class="pre">
         &amp;,
        </span>
        <span class="pre">
         |,
        </span>
        <span class="pre">
         ~
        </span>
       </code>
       have higher precedence
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boolean-indexes-are-pandas-series-you-can-save-and-re-use">
       Boolean indexes are
       <strong>
        Pandas series
       </strong>
       - you can save and re-use
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#isin-operator-function">
     <code class="docutils literal notranslate">
      <span class="pre">
       isin
      </span>
     </code>
     operator/function
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pandas-query-function">
     pandas
     <code class="docutils literal notranslate">
      <span class="pre">
       query
      </span>
     </code>
     function
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#combing-column-select-and-filter">
       Combing Column Select and filter
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-sorting-sorting-and-removing-duplicates-a">
   <a name="sorting" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Sorting and removing duplicates
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-grouping-grouping-and-aggregation-a">
   <a name="grouping" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Grouping and Aggregation
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#you-need-an-aggregator-or-iterator-make-use-of-grouping">
     You need an aggregator (or iterator) make use of grouping
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iterating-over-groups-groupby-returns-an-iterable">
     Iterating over groups -
     <code class="docutils literal notranslate">
      <span class="pre">
       groupby
      </span>
     </code>
     returns an iterable
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grouping-with-multiple-aggregation-functions">
     Grouping with Multiple aggregation functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grouping-with-multiple-columns">
     Grouping with multiple columns
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-pd-grouper-to-group-by-time-interval">
     Using pd.Grouper to group by time interval
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-adding-columns-adding-and-removing-columns-a">
   <a name="adding-columns" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Adding and removing columns
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assign-function">
     <code class="docutils literal notranslate">
      <span class="pre">
       assign
      </span>
     </code>
     function
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#drop-columns">
       Drop columns
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-other-quick-ways-of-filtering-out-in-columns">
     Some other quick ways of filtering out (in) columns
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-simple-joins-simple-joins-a">
   <a name="simple-joins" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Simple Joins
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concatenating-dfs">
     Concatenating DFs
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#joining-rows">
       Joining rows
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ignore-index-true-causes-python-to-regenerate-a-new-index">
         <code class="docutils literal notranslate">
          <span class="pre">
           ignore_index=True
          </span>
         </code>
         causes Python to regenerate a new index
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#joining-columns-horizontal">
     Joining columns (horizontal)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-stats-101-statistics-101-with-pandas-a">
   <a name="stats-101" style="border: solid; padding:5pt; color:black; background-color:#90CAF9">
    Statistics 101 with Pandas
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-types">
     Data Types
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-data">
       <strong>
        Numerical
       </strong>
       data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#categorical-data">
       <strong>
        Categorical
       </strong>
       data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#descriptive-analysis-for-categorical-data">
     Descriptive Analysis for Categorical data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#categorical-data-types-in-pandas">
       <strong>
        Categorical data types
       </strong>
       in Pandas
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#describe-method">
       <strong>
        Describe Method
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#frequency-of-values">
       <strong>
        Frequency of Values
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#central-tendency">
       <strong>
        Central Tendency
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#correlation">
       <strong>
        Correlation
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#descriptive-analysis-for-numerical-data">
     Descriptive Analysis for Numerical data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-data-type-in-pandas">
       <strong>
        Numerical data type
       </strong>
       in Pandas
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       <strong>
        Describe Method
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       <strong>
        Frequency of Values
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       <strong>
        Central Tendency
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#shape-of-distribution-of-frequencies">
       <strong>
        Shape of Distribution of Frequencies
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variability">
       <strong>
        Variability
       </strong>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       <strong>
        Correlation
       </strong>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#end-of-session">
   End of Session
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#font-color-peru-break-5-minutes-font">
   <font color="peru">
    Break: 5 Minutes
   </font>
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><img alt="Banner" src="../../_images/banner1.png" /></p>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="workshop-1-3-font-color-peru-basics-of-data-analysis-with-pandas-font">
<h1>Workshop 1.3: <font color=peru>Basics of Data Analysis with Pandas</font><a class="headerlink" href="#workshop-1-3-font-color-peru-basics-of-data-analysis-with-pandas-font" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p><strong>Contributors</strong>:</p>
<ul>
<li><p>Jose Rodriguez (&#64;Cyb3rPandah)</p></li>
<li><p>Ian Hellen (&#64;ianhellen)</p></li>
<li><p>Pete Bryan (&#64;Pete Bryan)
<br><br></p></li>
</ul>
</li>
<li><p><strong>Agenda</strong>:</p>
<ul>
<li><p>Part 1</p>
<ul>
<li><p><a class="reference external" href="#import-pandas">Importing the Pandas Library</a></p></li>
<li><p><a class="reference external" href="#dataframe">DataFrame, an organized way to represent data</a></p>
<ul>
<li><p>Pandas Structures</p></li>
<li><p>Importing data</p></li>
</ul>
</li>
<li><p><a class="reference external" href="#interacting">Interacting with DataFrames</a></p>
<ul>
<li><p>Selecting columns</p></li>
<li><p>Indexes</p></li>
<li><p>Accessing individual values</p></li>
<li><p>pandas I/O functions</p></li>
</ul>
</li>
<li><p><a class="reference external" href="#selecting">Selection and Filtering</a></p></li>
</ul>
</li>
<li><p>Part 2</p>
<ul>
<li><p><a class="reference external" href="#sorting">Sorting and removing duplicates</a></p></li>
<li><p><a class="reference external" href="#grouping">Grouping</a></p></li>
<li><p><a class="reference external" href="#adding-columns">Adding and removing columns</a></p></li>
<li><p><a class="reference external" href="#simple-joins">Simple joins</a></p></li>
<li><p><a class="reference external" href="#stats-101">Statistics 101</a>
<br><br></p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Notebook</strong>: <a class="reference external" href="https://aka.ms/Jupyterthon-ws-1-3">https://aka.ms/Jupyterthon-ws-1-3</a></p></li>
<li><p><strong>License</strong>: <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a></p></li>
<li><p><strong>Q&amp;A</strong> - OTR Discord <strong>#Jupyterthon #WORKSHOP DAY 1 - BASICS OF DATA ANALYSIS</strong></p></li>
</ul>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-import-pandas-importing-the-pandas-library-a">
<h1><a style="border: solid; padding:5pt; color:black; background-color:#90CAF9" name="import-pandas">Importing the Pandas Library</a><a class="headerlink" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-import-pandas-importing-the-pandas-library-a" title="Permalink to this headline">#</a></h1>
<p>This entire section of the workshop is based on the <strong><a class="reference external" href="https://pandas.pydata.org/">Pandas</a></strong> Python Library. Therefore, it makes sense to start by importing the library.</p>
<p>If you have not installed <strong>pandas</strong> yet, you can install it via <strong><a class="reference external" href="https://pypi.org/project/pip/">pip</a></strong> by running the following code in a notebook cell:</p>
<p><strong>%pip install pandas</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-dataframe-representing-data-in-an-organized-way-dataframe-a">
<h1><a style="border: solid; padding:5pt; color:black; background-color:#90CAF9" name="dataframe">Representing data in an Organized way: Dataframe</a><a class="headerlink" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-dataframe-representing-data-in-an-organized-way-dataframe-a" title="Permalink to this headline">#</a></h1>
<div class="section" id="pandas-structures">
<h2>Pandas Structures<a class="headerlink" href="#pandas-structures" title="Permalink to this headline">#</a></h2>
<div class="section" id="series">
<h3>Series<a class="headerlink" href="#series" title="Permalink to this headline">#</a></h3>
<p>A <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html">Pandas Series</a></strong> is a one-dimensional array-like object that can hold any data type, with a single Series holding multiple data types if needed. The axis labels area refered to as index.</p>
<p>They can be created from a range of different Python data structures, including a list, ndarry, dictionary or scalar value.</p>
<ul class="simple">
<li><p>If creating from an <strong><a class="reference external" href="https://docs.python.org/3/tutorial/introduction.html#lists">list</a></strong> like below we can either specify the index or one can be automatically created.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Item 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Item 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Item 3&quot;</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="c1">#pd.Series(data, index=[&quot;A&quot;,&quot;B&quot;,&quot;C&quot;])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    Item 1
2    Item 2
3    Item 3
dtype: object
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>When creating from a <strong><a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">dictionary</a></strong> an index does not need to be supplied and will be infered from the Dictionary keys:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 1&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 2&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 3&quot;</span><span class="p">}</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    Item 1
B    Item 2
C    Item 3
dtype: object
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>You can also attach names to a Series by using the parameter <strong>name</strong>. This can help with later understanding.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 1&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 2&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 3&quot;</span><span class="p">}</span>
<span class="n">examples_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dictionary Series&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">examples_series</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Name of my Series: &#39;</span><span class="p">,</span><span class="n">examples_series</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    Item 1
B    Item 2
C    Item 3
Name: Dictionary Series, dtype: object
Name of my Series:  Dictionary Series
</pre></div>
</div>
</div>
</div>
<p>You can find more details about <strong>Pandas Series</strong> here:</p>
<p><strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html</a></strong></p>
</div>
<div class="section" id="dataframe">
<h3>DataFrame<a class="headerlink" href="#dataframe" title="Permalink to this headline">#</a></h3>
<p>A <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">Pandas DataFrame</a></strong> is a two-dimensional tabular data structure with labeled axes (rows and columns). Similar to a table.</p>
<p>A DataFrame can be considered to be make up for multiple Series, with each row being its own Series, and as with Series not each column in an DataFrame is necessarily the same type of data.</p>
<p>DataFrames can be created from a range of input types including Pythos data structures such as lists, tuples, dictionaries, Series, ndarrays, or other DataFrames.</p>
<p>As well as the index that a Series has, DataFrames have a second index called ‘columns’, which contains the names assigned to each column in the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Item 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Item 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Item 3&quot;</span><span class="p">],</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;6.0&quot;</span><span class="p">,</span> <span class="s2">&quot;3.2&quot;</span><span class="p">,</span> <span class="s2">&quot;11.9&quot;</span><span class="p">],</span> <span class="s2">&quot;Count&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">111</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">82</span><span class="p">]}</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Value</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Item 1</td>
      <td>6.0</td>
      <td>111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Item 2</td>
      <td>3.2</td>
      <td>720</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Item 3</td>
      <td>11.9</td>
      <td>82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>In the example above the columns are infered from the keys of the <strong><a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">dictionary</a></strong> and the index is autogenearted. If needed, we can also specify index values by using the <strong>index</strong> parameter:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Item 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Item 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Item 3&quot;</span><span class="p">],</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;6.0&quot;</span><span class="p">,</span> <span class="s2">&quot;3.2&quot;</span><span class="p">,</span> <span class="s2">&quot;11.9&quot;</span><span class="p">],</span> <span class="s2">&quot;Count&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">111</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">82</span><span class="p">]}</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Item 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Item 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Item 3&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Value</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Item 1</th>
      <td>Item 1</td>
      <td>6.0</td>
      <td>111</td>
    </tr>
    <tr>
      <th>Item 2</th>
      <td>Item 2</td>
      <td>3.2</td>
      <td>720</td>
    </tr>
    <tr>
      <th>Item 3</th>
      <td>Item 3</td>
      <td>11.9</td>
      <td>82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>You can also create a DataFrame from a group of <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html">Series</a></strong>:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 1&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;12.3&quot;</span><span class="p">}</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 4&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;17.1&quot;</span><span class="p">}</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">data2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Item 1</td>
      <td>1</td>
      <td>12.3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Item 4</td>
      <td>6</td>
      <td>17.1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>You can also choose to use a column as the index if you wish:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 1&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;12.3&quot;</span><span class="p">}</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;Item 4&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;17.1&quot;</span><span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">data2</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
    <tr>
      <th>A</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Item 1</th>
      <td>1</td>
      <td>12.3</td>
    </tr>
    <tr>
      <th>Item 4</th>
      <td>6</td>
      <td>17.1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can find more details about <strong>Pandas DataFrames</strong> here:</p>
<p><strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html</a></strong></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="importing-data-as-a-pandas-dataframe">
<h2>Importing data as a Pandas DataFrame<a class="headerlink" href="#importing-data-as-a-pandas-dataframe" title="Permalink to this headline">#</a></h2>
<p>In the previous section, we showed how to create a Pandas DataFrame from Python data structures such as Series and Dictionaries.</p>
<p>In addition to this, Pandas contains several <strong>READ</strong> methods that allow us to convert data stored in different formats such as <em>JSON, EXCEL(CSV, XLSX), SQL, HTML, XML, and PICKLE</em>.</p>
<div class="section" id="importing-json-files">
<h3>Importing <strong>JSON</strong> files<a class="headerlink" href="#importing-json-files" title="Permalink to this headline">#</a></h3>
<p>We already showed to you how to import a JSON file using the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.io.json.read_json.html">read_json</a></strong> method.</p>
<p>Additionally to the pandas library we imported at the beginning of the session, we will need to import the <strong>JSON</strong> module from <strong><a class="reference external" href="http://pandas.io">pandas.io</a></strong> in order to be able to use the <em>read_json</em> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas.io</span> <span class="kn">import</span> <span class="n">json</span>
</pre></div>
</div>
</div>
</div>
<p>Now we should be able to read our <strong>JSON</strong> file (List of Dictionaries). As you can see in the code below, the read_json method returns a <strong>Pandas DataFrame</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">json_df</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="s1">&#39;../data/techniques_to_events_mapping.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">json_df</span><span class="p">))</span>
<span class="n">json_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>technique_id</th>
      <th>x_mitre_is_subtechnique</th>
      <th>technique</th>
      <th>tactic</th>
      <th>platform</th>
      <th>data_source</th>
      <th>data_component</th>
      <th>name</th>
      <th>source</th>
      <th>relationship</th>
      <th>target</th>
      <th>event_id</th>
      <th>event_name</th>
      <th>event_platform</th>
      <th>audit_category</th>
      <th>audit_sub_category</th>
      <th>log_channel</th>
      <th>log_provider</th>
      <th>filter_in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>T1547.004</td>
      <td>True</td>
      <td>Winlogon Helper DLL</td>
      <td>[persistence, privilege-escalation]</td>
      <td>[Windows]</td>
      <td>windows registry</td>
      <td>windows registry key modification</td>
      <td>Process modified Windows registry key value</td>
      <td>process</td>
      <td>modified</td>
      <td>windows registry key value</td>
      <td>13</td>
      <td>RegistryEvent (Value Set).</td>
      <td>Windows</td>
      <td>RegistryEvent</td>
      <td>None</td>
      <td>Microsoft-Windows-Sysmon/Operational</td>
      <td>Microsoft-Windows-Sysmon</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Each dictionary within the JSON file we read previously is stored in different lines. What if each dictionary is stored in one line of our JSON file? This is the case of pre-recorded datasets from our <strong>Security Datasets</strong> OTR Project.</p>
<p>In this case we will need to set the parameter <strong>lines</strong> to <strong>True</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">json_df2</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="s1">&#39;../data/empire_shell_net_localgroup_administrators_2020-09-21191843.json&#39;</span><span class="p">,</span><span class="n">lines</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">json_df2</span><span class="p">))</span>
<span class="n">json_df2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Keywords</th>
      <th>SeverityValue</th>
      <th>TargetObject</th>
      <th>EventTypeOrignal</th>
      <th>EventID</th>
      <th>ProviderGuid</th>
      <th>ExecutionProcessID</th>
      <th>host</th>
      <th>Channel</th>
      <th>UserID</th>
      <th>...</th>
      <th>SourceIsIpv6</th>
      <th>DestinationPortName</th>
      <th>DestinationHostname</th>
      <th>Service</th>
      <th>Details</th>
      <th>ShareName</th>
      <th>EnabledPrivilegeList</th>
      <th>DisabledPrivilegeList</th>
      <th>ShareLocalPath</th>
      <th>RelativeTargetName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-9223372036854775808</td>
      <td>2</td>
      <td>HKU\S-1-5-21-4228717743-1032521047-1810997296-...</td>
      <td>INFO</td>
      <td>12</td>
      <td>{5770385F-C22A-43E0-BF4C-06F5698FFBD9}</td>
      <td>3172</td>
      <td>wec.internal.cloudapp.net</td>
      <td>Microsoft-Windows-Sysmon/Operational</td>
      <td>S-1-5-18</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 155 columns</p>
</div></div></div>
</div>
<p>If your JSON file contains columns that store <strong>dates</strong>, you can use the parameter <strong>convert_dates</strong> to convert strings into values with date format. For example, lets check the type of value for the first record of the column <strong>&#64;timestamp</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">json_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;@timestamp&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>str
</pre></div>
</div>
</div>
</div>
<p>As you can see in the output of the previous cell, the type of value is <strong>str</strong> or string. Let’s read the JSON file setting the parameter <strong>convert_dates</strong> with a list that contains the names of the columns that store dates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">json_df2_dates</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="s1">&#39;../data/empire_shell_net_localgroup_administrators_2020-09-21191843.json&#39;</span><span class="p">,</span>
                          <span class="n">lines</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">convert_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;@timestamp&#39;</span><span class="p">])</span>
<span class="nb">type</span><span class="p">(</span><span class="n">json_df2_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;@timestamp&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas._libs.tslibs.timestamps.Timestamp
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="importing-csv-files">
<h3>Importing <strong>CSV</strong> files<a class="headerlink" href="#importing-csv-files" title="Permalink to this headline">#</a></h3>
<p>Another useful format in InfoSec is CSV (Comma Separated Values). To import a CSV file we will use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">read_csv</a></strong> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csv_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/process_tree.csv&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">csv_df</span><span class="p">))</span>
<span class="n">csv_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>TenantId</th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserSid</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectLogonId</th>
      <th>...</th>
      <th>NewProcessName</th>
      <th>TokenElevationType</th>
      <th>ProcessId</th>
      <th>CommandLine</th>
      <th>ParentProcessName</th>
      <th>TargetLogonId</th>
      <th>SourceComputerId</th>
      <th>TimeCreatedUtc</th>
      <th>NodeRole</th>
      <th>Level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>802d39e1-9d70-404d-832c-2de5e2478eda</td>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4688</td>
      <td>2019-01-15 05:15:15.677</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>0xfaac27</td>
      <td>...</td>
      <td>C:\Diagnostics\UserTmp\ftp.exe</td>
      <td>%%1936</td>
      <td>0xbc8</td>
      <td>.\ftp  -s:C:\RECYCLER\xxppyy.exe</td>
      <td>C:\Windows\System32\cmd.exe</td>
      <td>0x0</td>
      <td>46fe7078-61bb-4bed-9430-7ac01d91c273</td>
      <td>2019-01-15 05:15:15.677</td>
      <td>source</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 21 columns</p>
</div></div></div>
</div>
<p>If your CSV file contains columns that store <strong>dates</strong>, you can use the parameter <strong>parse_dates</strong> to convert strings into values with date format. For example, lets check the type of value for the first record of the column <strong>TimeGenerated</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">csv_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;str&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>As you can see in the output of the previous cell, the type of value is <strong>str</strong> or string. Let’s read the CSV file setting the parameter <strong>parse_dates</strong> with a list that contains the names of the columns that store dates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csv_df_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/process_tree.csv&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">csv_df_date</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas._libs.tslibs.timestamps.Timestamp&#39;&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="notes-on-csv-files">
<h3>Notes on CSV Files<a class="headerlink" href="#notes-on-csv-files" title="Permalink to this headline">#</a></h3>
<p>Other useful options for CSV include:</p>
<p style="font-family:consolas; font-size:12pt; color:green">
pd.read_csv(<br>
&nbsp;&nbsp;file_path,<br>
&nbsp;&nbsp;<b>index_col=0</b>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# if CSV already has an index col<br>
&nbsp;&nbsp;<b>header=row_num</b>,&nbsp;&nbsp;&nbsp;# which row headers are found in (def = first row)<br> 
&nbsp;&nbsp;<b>on_bad_lines="warn"</b>, # warn but don't fail on line parsing (other options are "error", "skip"<br>
)
<p></div>
<div class="section" id="importing-pickle-files">
<h3>Importing <strong>PICKLE</strong> files<a class="headerlink" href="#importing-pickle-files" title="Permalink to this headline">#</a></h3>
<p>Another useful format in InfoSec is PICKLE. This type of files can be used to serialize Python object structures such as dictionaries, tuples, and lists. To import a PICKLE file we will use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_pickle.html">read_pickle</a></strong> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pkl_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;../data/host_logons.pkl&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">pkl_df</span><span class="p">))</span>
<span class="n">pkl_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:56:34.307</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:56:34.307</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="importing-remote-files">
<h3>Importing <strong>Remote Files</strong><a class="headerlink" href="#importing-remote-files" title="Permalink to this headline">#</a></h3>
<p>Most <strong>read_</strong>* methods accept a path to the local file system and some of them accept paths to remote files. Let’s check an example with a <strong>remote CSV file</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csv_remote</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="o">=</span><span class="s1">&#39;https://raw.githubusercontent.com/OTRF/OSSEM-DM/main/use-cases/mitre_attack/attack_events_mapping.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">csv_remote</span><span class="p">))</span>
<span class="n">csv_remote</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Data Source</th>
      <th>Component</th>
      <th>Source</th>
      <th>Relationship</th>
      <th>Target</th>
      <th>EventID</th>
      <th>Event Name</th>
      <th>Event Platform</th>
      <th>Log Provider</th>
      <th>Log Channel</th>
      <th>Audit Category</th>
      <th>Audit Sub-Category</th>
      <th>Enable Commands</th>
      <th>GPO Audit Policy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>User Account</td>
      <td>user account authentication</td>
      <td>user</td>
      <td>attempted to authenticate from</td>
      <td>port</td>
      <td>4624</td>
      <td>An account was successfully logged on.</td>
      <td>Windows</td>
      <td>Microsoft-Windows-Security-Auditing</td>
      <td>Security</td>
      <td>Logon/Logoff</td>
      <td>Logon</td>
      <td>auditpol /set /subcategory:Logon /success:enab...</td>
      <td>Computer Configuration -&gt; Windows Settings -&gt; ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can find more details about <strong>Pandas’ read_</strong>* methods here:</p>
<p><strong><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html">https://pandas.pydata.org/docs/user_guide/io.html</a></strong></p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-interacting-interacting-with-dataframes-a">
<h1><a style="border: solid; padding:5pt; color:black; background-color:#90CAF9" name="interacting">Interacting with DataFrames</a><a class="headerlink" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-interacting-interacting-with-dataframes-a" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># We&#39;re going to read another data set in with more variety</span>
<span class="n">logons_full_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;../data/host_logons.pkl&quot;</span><span class="p">)</span>
<span class="n">net_full_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;../data/az_net_comms_df.pkl&quot;</span><span class="p">)</span>

<span class="c1"># also create a demo version with just 20 rows</span>
<span class="n">logons_df</span> <span class="o">=</span> <span class="n">logons_full_df</span><span class="p">[</span><span class="n">logons_full_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span>
    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">155</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="p">)]</span>
<span class="n">logons_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>0</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc54c7b9</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="size-shape-of-a-dataframe">
<h2>Size/Shape of a DataFrame<a class="headerlink" href="#size-shape-of-a-dataframe" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape = rows x columns&quot;</span><span class="p">)</span>
<span class="n">logons_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape = rows x columns
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(20, 15)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">logons_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<div class="section" id="single-row-of-dataframe-series">
<h3>Single row of DataFrame == Series<a class="headerlink" href="#single-row-of-dataframe-series" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type of single row - logons_df.iloc[0])&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># First row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Account                   NT AUTHORITY\SYSTEM
EventID                                  4624
TimeGenerated      2019-02-12 04:44:10.343000
Computer                      MSTICAlertsWin1
SubjectUserName              MSTICAlertsWin1$
Name: 8, dtype: object
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type of single row - logons_df.iloc[0]) &lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="intersection-of-a-row-and-column-is-a-simple-type-the-cell-content">
<h3>Intersection of a row and column is a simple type - the cell content<a class="headerlink" href="#intersection-of-a-row-and-column-is-a-simple-type-the-cell-content" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Intersection - logons_df.iloc[0].Account&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Account</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Value:&quot;</span><span class="p">,</span> <span class="n">logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Account</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intersection - logons_df.iloc[0].Account
Type: &lt;class &#39;str&#39;&gt;
Value: NT AUTHORITY\SYSTEM
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="selecting-columns">
<h2>Selecting Columns<a class="headerlink" href="#selecting-columns" title="Permalink to this headline">#</a></h2>
<p style="font-family:consolas; font-size:15pt; color:green">
df.<i>column_name</i><br>
df[<i>column_name</i>]
</p><p>Selecting a single column</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">Account</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8            NT AUTHORITY\SYSTEM
9            NT AUTHORITY\SYSTEM
12           NT AUTHORITY\SYSTEM
29           NT AUTHORITY\SYSTEM
31    MSTICAlertsWin1\MSTICAdmin
Name: Account, dtype: object
</pre></div>
</div>
</div>
</div>
<p>More general syntax (and mandatory if column name has spaces or other illegal chars, like “.”, “-”)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8            NT AUTHORITY\SYSTEM
9            NT AUTHORITY\SYSTEM
12           NT AUTHORITY\SYSTEM
29           NT AUTHORITY\SYSTEM
31    MSTICAlertsWin1\MSTICAdmin
Name: Account, dtype: object
</pre></div>
</div>
</div>
</div>
<p>To select multiple columns you use a Python list as the column selector</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span>
<span class="n">logons_df</span><span class="p">[</span><span class="n">my_cols</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>TimeGenerated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Or an inline/literal list</p>
<p>Note the double “[[” “]]” - indicating a [list], within the [] indexer syntax</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[[</span><span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>TimeGenerated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="use-the-columns-property-to-get-the-column-names">
<h3>Use the columns property to get the column names<a class="headerlink" href="#use-the-columns-property-to-get-the-column-names" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Account&#39;, &#39;EventID&#39;, &#39;TimeGenerated&#39;, &#39;Computer&#39;, &#39;SubjectUserName&#39;,
       &#39;SubjectDomainName&#39;, &#39;SubjectUserSid&#39;, &#39;TargetUserName&#39;,
       &#39;TargetDomainName&#39;, &#39;TargetUserSid&#39;, &#39;TargetLogonId&#39;, &#39;LogonType&#39;,
       &#39;IpAddress&#39;, &#39;WorkstationName&#39;, &#39;TimeCreatedUtc&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="indexes-brief-introduction">
<h2>Indexes - brief introduction<a class="headerlink" href="#indexes-brief-introduction" title="Permalink to this headline">#</a></h2>
<p>Pandas default index is a monotonically-increasing integer (a Python range)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([  8,   9,  12,  29,  31,  36,  46,  68,  70,  73,  74,  93, 100,
            110, 111, 130, 135, 142, 146, 155],
           dtype=&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
<p style="font-family:consolas; font-size:15pt; color:green">
df.loc[<i>index_value</i>]<br>vs.<br>
df.iloc[<i>row#</i>]
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access a row at an index location</span>
<span class="n">logons_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Account                     NT AUTHORITY\SYSTEM
EventID                                    4624
TimeGenerated        2019-02-12 04:44:10.343000
Computer                        MSTICAlertsWin1
SubjectUserName                MSTICAlertsWin1$
SubjectDomainName                     WORKGROUP
SubjectUserSid                         S-1-5-18
TargetUserName                           SYSTEM
TargetDomainName                   NT AUTHORITY
TargetUserSid                          S-1-5-18
TargetLogonId                             0x3e7
LogonType                                     5
IpAddress                                     -
WorkstationName                               -
TimeCreatedUtc       2019-02-12 04:44:10.343000
Name: 8, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access a row at a physical row location</span>
<span class="n">logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Account                     NT AUTHORITY\SYSTEM
EventID                                    4624
TimeGenerated        2019-02-14 04:20:54.370000
Computer                        MSTICAlertsWin1
SubjectUserName                               -
SubjectDomainName                             -
SubjectUserSid                          S-1-0-0
TargetUserName                           SYSTEM
TargetDomainName                   NT AUTHORITY
TargetUserSid                          S-1-5-18
TargetLogonId                             0x3e7
LogonType                                     0
IpAddress                                     -
WorkstationName                               -
TimeCreatedUtc       2019-02-14 04:20:54.370000
Name: 70, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="section" id="setting-another-column-as-index">
<h3>Setting another column as index<a class="headerlink" href="#setting-another-column-as-index" title="Permalink to this headline">#</a></h3>
<p style="font-family:consolas; font-size:15pt; color:green; color:green">
df.set_index(<i>column_name</i>)
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indexed_logons_df</span> <span class="o">=</span> <span class="n">logons_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Account&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Default index&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">logons_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indexed by Account column&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">indexed_logons_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Default index
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>0</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Indexed by Account column
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
    <tr>
      <th>Account</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NT AUTHORITY\SYSTEM</th>
      <td>4624</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>NT AUTHORITY\SYSTEM</th>
      <td>4624</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>NT AUTHORITY\SYSTEM</th>
      <td>4624</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>0</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Locating rows by index value</p>
<p>(note index is NOT unique)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">indexed_logons_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;MSTICAlertsWin1</span><span class="se">\\</span><span class="s2">MSTICAdmin&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
    <tr>
      <th>Account</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MSTICAlertsWin1\MSTICAdmin</th>
      <td>4624</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc54c7b9</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
    <tr>
      <th>MSTICAlertsWin1\MSTICAdmin</th>
      <td>4624</td>
      <td>2019-02-11 09:58:48.773</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xbd57571</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 09:58:48.773</td>
    </tr>
    <tr>
      <th>MSTICAlertsWin1\MSTICAdmin</th>
      <td>4624</td>
      <td>2019-02-15 03:56:57.070</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0x1096a6d</td>
      <td>3</td>
      <td>131.107.147.209</td>
      <td>IANHELLE-DEV17</td>
      <td>2019-02-15 03:56:57.070</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Physical row indexing works as before - not affected by index</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indexed_logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EventID                                    4624
TimeGenerated        2019-02-12 04:40:11.867000
Computer                        MSTICAlertsWin1
SubjectUserName                MSTICAlertsWin1$
SubjectDomainName                     WORKGROUP
SubjectUserSid                         S-1-5-18
TargetUserName                           SYSTEM
TargetDomainName                   NT AUTHORITY
TargetUserSid                          S-1-5-18
TargetLogonId                             0x3e7
LogonType                                     5
IpAddress                                     -
WorkstationName                               -
TimeCreatedUtc       2019-02-12 04:40:11.867000
Name: NT AUTHORITY\SYSTEM, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="accessing-individual-cell-values">
<h2>Accessing individual (“cell”) values<a class="headerlink" href="#accessing-individual-cell-values" title="Permalink to this headline">#</a></h2>
<div class="section" id="a-single-value">
<h3>A single value<a class="headerlink" href="#a-single-value" title="Permalink to this headline">#</a></h3>
<p>Like many things in pandas there are several ways to do something!</p>
<p style="font-family:consolas; font-size:15pt; color:green">
df.iloc[expr].ColumnName</p>
iloc to specify a row number + column selector
<p style="font-family:consolas; font-size:15pt; color:green">
df.at[index_expr, ColumnName]
</p>
at with an index expression + column name
<p style="font-family:consolas; font-size:15pt; color:green">
df.iat[row#, col#]
</p>
<p>iat is like iloc but in 2 dimensions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iloc + named column&quot;</span><span class="p">,</span> <span class="n">logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Account</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;at - row idx + named column&quot;</span><span class="p">,</span> <span class="n">logons_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;Account&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iat - row idx + column idx&quot;</span><span class="p">,</span> <span class="n">logons_df</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iloc + named column NT AUTHORITY\SYSTEM
at - row idx + named column NT AUTHORITY\SYSTEM
iat - row idx + column idx 4624
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="retrieving-values-from-a-pandas-series">
<h3>Retrieving values from a pandas series<a class="headerlink" href="#retrieving-values-from-a-pandas-series" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">logons_df</span><span class="o">.</span><span class="n">Account</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">logons_df</span><span class="o">.</span><span class="n">Account</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;NT AUTHORITY\\SYSTEM&#39; &#39;NT AUTHORITY\\SYSTEM&#39; &#39;NT AUTHORITY\\SYSTEM&#39;
 &#39;NT AUTHORITY\\SYSTEM&#39; &#39;MSTICAlertsWin1\\MSTICAdmin&#39;]
[&#39;NT AUTHORITY\\SYSTEM&#39;, &#39;NT AUTHORITY\\SYSTEM&#39;, &#39;NT AUTHORITY\\SYSTEM&#39;, &#39;NT AUTHORITY\\SYSTEM&#39;, &#39;MSTICAlertsWin1\\MSTICAdmin&#39;]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="pandas-i-o-functions">
<h2>pandas I/O functions<a class="headerlink" href="#pandas-i-o-functions" title="Permalink to this headline">#</a></h2>
<p>We covered import from CSV and JSON.</p>
<p>Some notes:</p>
<ul class="simple">
<li><p>CSV is universal but a bit nasty and very inefficient.</p></li>
<li><p>Pickle is good but has changing different format across different Python version</p></li>
</ul>
<p>Other good options are:</p>
<ul class="simple">
<li><p>Parquet</p></li>
<li><p>HDF</p></li>
<li><p>Feather</p></li>
</ul>
<div class="section" id="dataframe-input-functions">
<h3>DataFrame input functions<a class="headerlink" href="#dataframe-input-functions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">func_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">pd</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">func_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;read_&quot;</span><span class="p">):</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">func_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">func_name</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">20</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">func_name</span><span class="p">))</span> <span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>read_clipboard :       Read text from clipboard and pass to read_csv.
read_csv :             Read a comma-separated values (csv) file into DataFrame.
read_excel :           Read an Excel file into a pandas DataFrame.
read_feather :         Load a feather-format object from the file path.
read_fwf :             Read a table of fixed-width formatted lines into DataFrame.
read_gbq :             Load data from Google BigQuery.
read_hdf :             Read from the store, close it if we opened it.
read_html :            Read HTML tables into a ``list`` of ``DataFrame`` objects.
read_json :            Convert a JSON string to pandas object.
read_orc :             Load an ORC object from the file path, returning a DataFrame.
read_parquet :         Load a parquet object from the file path, returning a DataFrame.
read_pickle :          Load pickled pandas object (or any object) from file.
read_sas :             Read SAS files stored as either XPORT or SAS7BDAT format files.
read_spss :            Load an SPSS file from the file path, returning a DataFrame.
read_sql :             Read SQL query or database table into a DataFrame.
read_sql_query :       Read SQL query into a DataFrame.
read_sql_table :       Read SQL database table into a DataFrame.
read_stata :           Read Stata file into DataFrame.
read_table :           Read general delimited file into DataFrame.
read_xml :             Read XML document into a ``DataFrame`` object.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dataframe-output-functions">
<h3>DataFrame output functions<a class="headerlink" href="#dataframe-output-functions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
<span class="k">for</span> <span class="n">func_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">func_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;to_&quot;</span><span class="p">):</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">func_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">func_name</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">20</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">func_name</span><span class="p">))</span> <span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>to_clipboard :         Copy object to the system clipboard.
to_csv :               Write object to a comma-separated values (csv) file.
to_dict :              Convert the DataFrame to a dictionary.
to_excel :             Write object to an Excel sheet.
to_feather :           Write a DataFrame to the binary Feather format.
to_gbq :               Write a DataFrame to a Google BigQuery table.
to_hdf :               Write the contained data to an HDF5 file using HDFStore.
to_html :              Render a DataFrame as an HTML table.
to_json :              Convert the object to a JSON string.
to_latex :             Render object to a LaTeX tabular, longtable, or nested table/tabular.
to_markdown :          Print DataFrame in Markdown-friendly format.
to_numpy :             Convert the DataFrame to a NumPy array.
to_parquet :           Write a DataFrame to the binary parquet format.
to_period :            Convert DataFrame from DatetimeIndex to PeriodIndex.
to_pickle :            Pickle (serialize) object to file.
to_records :           Convert DataFrame to a NumPy record array.
to_sql :               Write records stored in a DataFrame to a SQL database.
to_stata :             Export DataFrame object to Stata dta format.
to_string :            Render a DataFrame to a console-friendly tabular output.
to_timestamp :         Cast to DatetimeIndex of timestamps, at *beginning* of period.
to_xarray :            Return an xarray object from the pandas object.
to_xml :               Render a DataFrame to an XML document.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="export-to-excel-typically-need-openpyxl-installed-and-excel-or-similar">
<h3>Export to Excel - typically need <code class="docutils literal notranslate"><span class="pre">openpyxl</span></code> installed (and Excel or similar)<a class="headerlink" href="#export-to-excel-typically-need-openpyxl-installed-and-excel-or-similar" title="Permalink to this headline">#</a></h3>
<p>But you don’t really need Excel any more when you have pandas!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;../data/excel_sample.xlsx&quot;</span><span class="p">)</span>

<span class="o">!</span>start ../data/excel_sample.xlsx
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="read-json-vs-json-normalize">
<h3>read_json vs json_normalize<a class="headerlink" href="#read-json-vs-json-normalize" title="Permalink to this headline">#</a></h3>
<p>We saw earlier how pandas can read json formatted as records.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">json_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">[</span>
<span class="s2">    {&quot;Computer&quot;:&quot;MSTICAlertsWin1&quot;,&quot;Account&quot;:&quot;MSTICAdmin&quot;,&quot;NewProcessName&quot;:&quot;ftp.exe&quot;},</span>
<span class="s2">    {&quot;Computer&quot;:&quot;MSTICAlertsWin1&quot;,&quot;Account&quot;:&quot;MSTICAdmin&quot;,&quot;NewProcessName&quot;:&quot;reg.exe&quot;},</span>
<span class="s2">    {&quot;Computer&quot;:&quot;MSTICAlertsWin1&quot;,&quot;Account&quot;:&quot;MSTICAdmin&quot;,&quot;NewProcessName&quot;:&quot;cmd.exe&quot;},</span>
<span class="s2">    {&quot;Computer&quot;:&quot;MSTICAlertsWin1&quot;,&quot;Account&quot;:&quot;MSTICAdmin&quot;,&quot;NewProcessName&quot;:&quot;rundll32.exe&quot;},</span>
<span class="s2">    {&quot;Computer&quot;:&quot;MSTICAlertsWin1&quot;,&quot;Account&quot;:&quot;MSTICAdmin&quot;,&quot;NewProcessName&quot;:&quot;rundll32.exe&quot;}</span>
<span class="s2">]</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">json_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Computer</th>
      <th>Account</th>
      <th>NewProcessName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAdmin</td>
      <td>ftp.exe</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAdmin</td>
      <td>reg.exe</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAdmin</td>
      <td>cmd.exe</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAdmin</td>
      <td>rundll32.exe</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAdmin</td>
      <td>rundll32.exe</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For nested structures you need <code class="docutils literal notranslate"><span class="pre">json_normalize</span></code></p>
<p>But <code class="docutils literal notranslate"><span class="pre">json_normalize</span></code> expects a Python <code class="docutils literal notranslate"><span class="pre">dict</span></code>, not JSON</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">json_nested_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">[</span>
<span class="s2">    {</span>
<span class="s2">        &quot;Computer&quot;:&quot;MSTICAlertsWin1&quot;,</span>
<span class="s2">        &quot;SubRecord&quot;: {&quot;NewProcessName&quot;:&quot;ftp.exe&quot;, &quot;pid&quot;: 1}</span>
<span class="s2">    },</span>
<span class="s2">    {</span>
<span class="s2">        &quot;Computer&quot;:&quot;MSTICAlertsWin1&quot;,</span>
<span class="s2">        &quot;SubRecord&quot;: {&quot;NewProcessName&quot;:&quot;reg.exe&quot;, &quot;pid&quot;: 2}</span>
<span class="s2">    },</span>
<span class="s2">    {</span>
<span class="s2">        &quot;Computer&quot;:&quot;MSTICAlertsWin1&quot;,</span>
<span class="s2">        &quot;SubRecord&quot;: {&quot;NewProcessName&quot;:&quot;cmd.exe&quot;, &quot;pid&quot;: 3}</span>
<span class="s2">    }</span>
<span class="s2">]</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">json_nested_text</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;oh-oh - raw JSON!:&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_nested_text</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>oh-oh - raw JSON!: &#39;str&#39; object has no attribute &#39;values&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Computer</th>
      <th>SubRecord.NewProcessName</th>
      <th>SubRecord.pid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>MSTICAlertsWin1</td>
      <td>ftp.exe</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MSTICAlertsWin1</td>
      <td>reg.exe</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MSTICAlertsWin1</td>
      <td>cmd.exe</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="read-html-to-read-tables-from-web-pages">
<h3>read_html to read tables from web pages<a class="headerlink" href="#read-html-to-read-tables-from-web-pages" title="Permalink to this headline">#</a></h3>
<p>Tables in the web page are returned as a list of DataFrames</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="s2">&quot;https://attack.mitre.org/tactics/enterprise/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>TA0043</td>
      <td>Reconnaissance</td>
      <td>The adversary is trying to gather information ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TA0042</td>
      <td>Resource Development</td>
      <td>The adversary is trying to establish resources...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TA0001</td>
      <td>Initial Access</td>
      <td>The adversary is trying to get into your network.</td>
    </tr>
    <tr>
      <th>3</th>
      <td>TA0002</td>
      <td>Execution</td>
      <td>The adversary is trying to run malicious code.</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TA0003</td>
      <td>Persistence</td>
      <td>The adversary is trying to maintain their foot...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TA0004</td>
      <td>Privilege Escalation</td>
      <td>The adversary is trying to gain higher-level p...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TA0005</td>
      <td>Defense Evasion</td>
      <td>The adversary is trying to avoid being detected.</td>
    </tr>
    <tr>
      <th>7</th>
      <td>TA0006</td>
      <td>Credential Access</td>
      <td>The adversary is trying to steal account names...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>TA0007</td>
      <td>Discovery</td>
      <td>The adversary is trying to figure out your env...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>TA0008</td>
      <td>Lateral Movement</td>
      <td>The adversary is trying to move through your e...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>TA0009</td>
      <td>Collection</td>
      <td>The adversary is trying to gather data of inte...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>TA0011</td>
      <td>Command and Control</td>
      <td>The adversary is trying to communicate with co...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>TA0010</td>
      <td>Exfiltration</td>
      <td>The adversary is trying to steal data.</td>
    </tr>
    <tr>
      <th>13</th>
      <td>TA0040</td>
      <td>Impact</td>
      <td>The adversary is trying to manipulate, interru...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-selecting-selecting-searching-a">
<h1><a style="border: solid; padding:5pt; color:black; background-color:#90CAF9" name="selecting">Selecting/Searching</a><a class="headerlink" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-selecting-selecting-searching-a" title="Permalink to this headline">#</a></h1>
<div class="section" id="specific-row-or-col-by-number">
<h2>Specific row (or col) by number<a class="headerlink" href="#specific-row-or-col-by-number" title="Permalink to this headline">#</a></h2>
<p style="font-family:consolas; font-size:15pt; color:green">
df.iloc[row#]/df.iloc[row-range]
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">Account</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;NT AUTHORITY\\SYSTEM&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc54c7b9</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
    <tr>
      <th>36</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-11 09:58:48.773</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xbd57571</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 09:58:48.773</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="you-can-go-full-numpy-and-use-iloc-with-int-indexing">
<h3>You can go full numpy and use <code class="docutils literal notranslate"><span class="pre">iloc</span></code> with int indexing<a class="headerlink" href="#you-can-go-full-numpy-and-use-iloc-with-int-indexing" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;NT AUTHORITY\\SYSTEM&#39;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="select-by-content-boolean-indexing">
<h2>Select by content - “Boolean indexing”<a class="headerlink" href="#select-by-content-boolean-indexing" title="Permalink to this headline">#</a></h2>
<div class="section" id="basic-operators">
<h3>Basic operators<a class="headerlink" href="#basic-operators" title="Permalink to this headline">#</a></h3>
<p style="font-family:consolas; font-size:15pt; color:green">
 ==<br>
 !=<br>
 >, <, >=, <=
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MSTICAlertsWin1</span><span class="se">\\</span><span class="s2">MSTICAdmin&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8      False
9      False
12     False
29     False
31      True
36      True
46     False
68     False
70     False
73     False
74     False
93     False
100    False
110    False
111    False
130    False
135    False
142    False
146    False
155     True
Name: Account, dtype: bool
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="use-boolean-result-of-expression-to-filter-dataframe">
<h3>Use boolean result of expression to filter DataFrame<a class="headerlink" href="#use-boolean-result-of-expression-to-filter-dataframe" title="Permalink to this headline">#</a></h3>
<p style="font-family:consolas; font-size:15pt; color:green">
df[<i>bool_expr</i>]
</p>
</div>
<div class="section" id="note">
<h3>Note<a class="headerlink" href="#note" title="Permalink to this headline">#</a></h3>
<p style="font-family:consolas; font-size:15pt; color:green">
df[<i>bool_expr</i>] == df.<b>loc</b>[<i>bool_expr</i>]
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MSTICAlertsWin1</span><span class="se">\\</span><span class="s2">MSTICAdmin&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc54c7b9</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
    <tr>
      <th>36</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-11 09:58:48.773</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xbd57571</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 09:58:48.773</td>
    </tr>
    <tr>
      <th>155</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-15 03:56:57.070</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0x1096a6d</td>
      <td>3</td>
      <td>131.107.147.209</td>
      <td>IANHELLE-DEV17</td>
      <td>2019-02-15 03:56:57.070</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="other-operators-with-boolean-indexing">
<h2>Other operators with boolean indexing<a class="headerlink" href="#other-operators-with-boolean-indexing" title="Permalink to this headline">#</a></h2>
<p>Operators vary depending on data type!!!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Account                      object
EventID                       int64
TimeGenerated        datetime64[ns]
Computer                     object
SubjectUserName              object
SubjectDomainName            object
SubjectUserSid               object
TargetUserName               object
TargetDomainName             object
TargetUserSid                object
TargetLogonId                object
LogonType                     int64
IpAddress                    object
WorkstationName              object
TimeCreatedUtc       datetime64[ns]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="section" id="pandas-supports-string-functions-but">
<h3>Pandas supports string functions - but<a class="headerlink" href="#pandas-supports-string-functions-but" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;MSTICAdmin&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_43952</span><span class="o">/</span><span class="mf">3533411303.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">logons_df</span><span class="p">[</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;MSTICAdmin&quot;</span><span class="p">)]</span>

<span class="nn">~\AppData\Roaming\Python\Python37\site-packages\pandas\core\generic.py</span> in <span class="ni">__getattr__</span><span class="nt">(self, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">5460</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_axis</span><span class="o">.</span><span class="n">_can_hold_identifiers_and_holds_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">5461</span>                 <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">5462</span>             <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5463</span> 
<span class="g g-Whitespace">   </span><span class="mi">5464</span>     <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

<span class="ne">AttributeError</span>: &#39;Series&#39; object has no attribute &#39;endswith&#39;
</pre></div>
</div>
</div>
</div>
<p>What is the <strong><code class="docutils literal notranslate"><span class="pre">logons_df[&quot;Account&quot;]</span></code></strong> in our <code class="docutils literal notranslate"><span class="pre">logons_df[&quot;Account&quot;].endswith(&quot;MSTICAdmin&quot;)</span></code> expression</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8             NT AUTHORITY\SYSTEM
9             NT AUTHORITY\SYSTEM
12            NT AUTHORITY\SYSTEM
29            NT AUTHORITY\SYSTEM
31     MSTICAlertsWin1\MSTICAdmin
36     MSTICAlertsWin1\MSTICAdmin
46            NT AUTHORITY\SYSTEM
68            NT AUTHORITY\SYSTEM
70            NT AUTHORITY\SYSTEM
73           Window Manager\DWM-1
74           Window Manager\DWM-1
93            NT AUTHORITY\SYSTEM
100          Window Manager\DWM-2
110           NT AUTHORITY\SYSTEM
111           NT AUTHORITY\SYSTEM
130           NT AUTHORITY\SYSTEM
135           NT AUTHORITY\SYSTEM
142           NT AUTHORITY\SYSTEM
146           NT AUTHORITY\SYSTEM
155    MSTICAlertsWin1\MSTICAdmin
Name: Account, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="we-need-to-tell-pandas-to-apply-string-operation-as-a-vector-function-to-the-series">
<h3>We need to tell pandas to apply string operation as a <em>vector function</em> to the series<a class="headerlink" href="#we-need-to-tell-pandas-to-apply-string-operation-as-a-vector-function-to-the-series" title="Permalink to this headline">#</a></h3>
<p style="font-family:consolas; font-size:15pt; color:green">
df[df[<i>column</i>].<b>str</b>.contains(<i>str_expr</i>)]
</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;MSTICAdmin&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8      False
9      False
12     False
29     False
31      True
36      True
46     False
68     False
70     False
73     False
74     False
93     False
100    False
110    False
111    False
130    False
135    False
142    False
146    False
155     True
Name: Account, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;MSTICAdmin&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc54c7b9</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
    <tr>
      <th>36</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-11 09:58:48.773</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xbd57571</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 09:58:48.773</td>
    </tr>
    <tr>
      <th>155</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-15 03:56:57.070</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0x1096a6d</td>
      <td>3</td>
      <td>131.107.147.209</td>
      <td>IANHELLE-DEV17</td>
      <td>2019-02-15 03:56:57.070</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="multiple-conditions">
<h2>Multiple conditions<a class="headerlink" href="#multiple-conditions" title="Permalink to this headline">#</a></h2>
<p style="font-family:consolas; font-size:15pt; color:green">
& == AND<br>
| == OR<br>
~ == NOT<br>
</p>
<p style="border:solid; font-size:15pt; padding:5pt">
Always use parentheses around individual expressions in composite logical expressions!
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span>
    <span class="p">(</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;SYSTEM&quot;</span><span class="p">))</span>
    <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">t1</span><span class="p">)</span>
    <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">t2</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span>
    <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;MSTICAdmin&quot;</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># We want to add a time expression</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2019-02-12 04:00&quot;</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2019-02-12 05:00&quot;</span><span class="p">)</span>
<span class="n">t1</span><span class="p">,</span> <span class="n">t2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Timestamp(&#39;2019-02-12 04:00:00&#39;), Timestamp(&#39;2019-02-12 05:00:00&#39;))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span>
    <span class="p">(</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;SYSTEM&quot;</span><span class="p">))</span>
    <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">t1</span><span class="p">)</span>
    <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">t2</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>0</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="without-parentheses-have-higher-precedence">
<h3>Without parentheses - <code class="docutils literal notranslate"><span class="pre">&amp;,</span> <span class="pre">|,</span> <span class="pre">~</span></code> have higher precedence<a class="headerlink" href="#without-parentheses-have-higher-precedence" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Without parentheses - `&amp;, |, ~` have higher precedence</span>
<span class="n">logons_df</span><span class="p">[</span>
    <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;MSTICAdmin&quot;</span><span class="p">)</span>
    <span class="o">&amp;</span>
    <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">t1</span>
    <span class="o">&amp;</span>
    <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">t2</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_43952</span><span class="o">/</span><span class="mf">3190794489.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;MSTICAdmin&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="o">&amp;</span>
<span class="ne">----&gt; </span><span class="mi">5</span>     <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">t1</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="o">&amp;</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">t2</span>

<span class="nn">~\AppData\Roaming\Python\Python37\site-packages\pandas\core\ops\common.py</span> in <span class="ni">new_method</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span>         <span class="n">other</span> <span class="o">=</span> <span class="n">item_from_zerodim</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> 
<span class="ne">---&gt; </span><span class="mi">65</span>         <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span> 
<span class="g g-Whitespace">     </span><span class="mi">67</span>     <span class="k">return</span> <span class="n">new_method</span>

<span class="nn">~\AppData\Roaming\Python\Python37\site-packages\pandas\core\arraylike.py</span> in <span class="ni">__and__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>     <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__and__&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span>     <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">59</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logical_method</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">and_</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span> 
<span class="g g-Whitespace">     </span><span class="mi">61</span>     <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__rand__&quot;</span><span class="p">)</span>

<span class="nn">~\AppData\Roaming\Python\Python37\site-packages\pandas\core\series.py</span> in <span class="ni">_logical_method</span><span class="nt">(self, other, op)</span>
<span class="g g-Whitespace">   </span><span class="mi">4957</span>         <span class="n">rvalues</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">extract_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4958</span> 
<span class="ne">-&gt; </span><span class="mi">4959</span>         <span class="n">res_values</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">logical_op</span><span class="p">(</span><span class="n">lvalues</span><span class="p">,</span> <span class="n">rvalues</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4960</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_result</span><span class="p">(</span><span class="n">res_values</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">res_name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4961</span> 

<span class="nn">~\AppData\Roaming\Python\Python37\site-packages\pandas\core\ops\array_ops.py</span> in <span class="ni">logical_op</span><span class="nt">(left, right, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">338</span>     <span class="k">if</span> <span class="n">should_extension_dispatch</span><span class="p">(</span><span class="n">lvalues</span><span class="p">,</span> <span class="n">rvalues</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span>         <span class="c1"># Call the method on lvalues</span>
<span class="ne">--&gt; </span><span class="mi">340</span>         <span class="n">res_values</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">lvalues</span><span class="p">,</span> <span class="n">rvalues</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span> 
<span class="g g-Whitespace">    </span><span class="mi">342</span>     <span class="k">else</span><span class="p">:</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for &amp;: &#39;numpy.ndarray&#39; and &#39;DatetimeArray&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span>
    <span class="p">(</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;LogonType&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
    <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span>
    <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">12</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>0</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
    <tr>
      <th>110</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:20:35.003</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:20:35.003</td>
    </tr>
    <tr>
      <th>111</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:05:29.523</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:05:29.523</td>
    </tr>
    <tr>
      <th>130</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 20:09:16.550</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 20:09:16.550</td>
    </tr>
    <tr>
      <th>135</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 20:30:34.990</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 20:30:34.990</td>
    </tr>
    <tr>
      <th>142</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 20:19:52.520</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 20:19:52.520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="boolean-indexes-are-pandas-series-you-can-save-and-re-use">
<h3>Boolean indexes are <strong>Pandas series</strong> - you can save and re-use<a class="headerlink" href="#boolean-indexes-are-pandas-series-you-can-save-and-re-use" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create individual criteria</span>
<span class="n">logon_type_3</span> <span class="o">=</span> <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;LogonType&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">hour_4</span> <span class="o">=</span> <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span> <span class="o">&gt;=</span> <span class="mi">4</span>
<span class="n">day_12</span> <span class="o">=</span> <span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">12</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use them together to filter</span>
<span class="n">logons_df</span><span class="p">[</span><span class="n">logon_type_3</span> <span class="o">&amp;</span> <span class="n">hour_4</span> <span class="o">&amp;</span> <span class="n">day_12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>0</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
    <tr>
      <th>110</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:20:35.003</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:20:35.003</td>
    </tr>
    <tr>
      <th>111</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:05:29.523</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:05:29.523</td>
    </tr>
    <tr>
      <th>130</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 20:09:16.550</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 20:09:16.550</td>
    </tr>
    <tr>
      <th>135</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 20:30:34.990</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 20:30:34.990</td>
    </tr>
    <tr>
      <th>142</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 20:19:52.520</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 20:19:52.520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="isin-operator-function">
<h2><code class="docutils literal notranslate"><span class="pre">isin</span></code> operator/function<a class="headerlink" href="#isin-operator-function" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="p">[</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;TargetUserName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;MSTICAdmin&quot;</span><span class="p">,</span> <span class="s2">&quot;SYSTEM&quot;</span><span class="p">])]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>0</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc54c7b9</td>
      <td>4</td>
      <td>-</td>
      <td>MSTICAlertsWin1</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="pandas-query-function">
<h2>pandas <code class="docutils literal notranslate"><span class="pre">query</span></code> function<a class="headerlink" href="#pandas-query-function" title="Permalink to this headline">#</a></h2>
<p style="font-family:consolas; font-size:15pt; color:green">
df.query(query_str)
</p>
Useful for simpler queries - and definitely nicer-looking but some limitations - only simple operators supported.
<p>Good for quick things but I prefer the boolean stuff for more complex queries.</p>
<p>To reference Python variables prefix the variable name with “&#64;” (see second example)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;TargetUserName == &#39;MSTICAdmin&#39; and TargetLogonId == &#39;0xc913737&#39;&quot;</span><span class="p">)</span>

<span class="n">logons_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;TargetUserName == &#39;MSTICAdmin&#39; and TimeGenerated &gt; @t1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>155</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-15 03:56:57.070</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0x1096a6d</td>
      <td>3</td>
      <td>131.107.147.209</td>
      <td>IANHELLE-DEV17</td>
      <td>2019-02-15 03:56:57.070</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The output of <code class="docutils literal notranslate"><span class="pre">query</span></code> is a DataFrame so you can also easily combine with boolean indexing</p>
<p>or part of a longer pandas expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">logons_df</span><span class="p">[</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;MST.*&quot;</span><span class="p">)]</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;TimeGenerated &gt; @t1&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>155</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-15 03:56:57.070</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0x1096a6d</td>
      <td>3</td>
      <td>131.107.147.209</td>
      <td>IANHELLE-DEV17</td>
      <td>2019-02-15 03:56:57.070</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="combing-column-select-and-filter">
<h3>Combing Column Select and filter<a class="headerlink" href="#combing-column-select-and-filter" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">logons_df</span><span class="p">[</span><span class="n">logons_df</span><span class="p">[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;MSTICAdmin&quot;</span><span class="p">)]</span>
    <span class="p">[[</span><span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;TimeGenerated&quot;</span><span class="p">]]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>TimeGenerated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
    <tr>
      <th>36</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-11 09:58:48.773</td>
    </tr>
    <tr>
      <th>155</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-15 03:56:57.070</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-sorting-sorting-and-removing-duplicates-a">
<h1><a style="border: solid; padding:5pt; color:black; background-color:#90CAF9" name="sorting">Sorting and removing duplicates</a><a class="headerlink" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-sorting-sorting-and-removing-duplicates-a" title="Permalink to this headline">#</a></h1>
<p style="font-family:consolas; font-size:15pt; color:green">
df.sort_values(<i>column</i>|<i>[column_list]</i>], [ascending=True|False])
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>146</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-15 06:51:51.500</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-15 06:51:51.500</td>
    </tr>
    <tr>
      <th>155</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4624</td>
      <td>2019-02-15 03:56:57.070</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0x1096a6d</td>
      <td>3</td>
      <td>131.107.147.209</td>
      <td>IANHELLE-DEV17</td>
      <td>2019-02-15 03:56:57.070</td>
    </tr>
    <tr>
      <th>68</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-14 04:21:37.637</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-14 04:21:37.637</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p style="font-family:consolas; font-size:15pt; color:green">
df.drop_duplicates()
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">logons_df</span><span class="p">[[</span><span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;LogonType&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Account&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>LogonType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>4</td>
    </tr>
    <tr>
      <th>155</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>5</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Window Manager\DWM-1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>100</th>
      <td>Window Manager\DWM-2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-grouping-grouping-and-aggregation-a">
<h1><a style="border: solid; padding:5pt; color:black; background-color:#90CAF9" name="grouping">Grouping and Aggregation</a><a class="headerlink" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-grouping-grouping-and-aggregation-a" title="Permalink to this headline">#</a></h1>
<p style="font-family:consolas; font-size:15pt; color:green">
df.groupby(<i>column</i>|<i>[column_list]</i>])
</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Account&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x000001D81E76DAC8&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="you-need-an-aggregator-or-iterator-make-use-of-grouping">
<h2>You need an aggregator (or iterator) make use of grouping<a class="headerlink" href="#you-need-an-aggregator-or-iterator-make-use-of-grouping" title="Permalink to this headline">#</a></h2>
<p>Add an aggregation function: sum, count, mean, stdev, etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Account&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># Yuk!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
    <tr>
      <th>Account</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MSTICAlertsWin1\MSTICAdmin</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>NT AUTHORITY\SYSTEM</th>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
    </tr>
    <tr>
      <th>Window Manager\DWM-1</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Window Manager\DWM-2</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Tidy up by limiting and renaming columns</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">logons_df</span><span class="p">[[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="s2">&quot;Account&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Account&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">:</span> <span class="s2">&quot;LogonCount&quot;</span><span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LogonCount</th>
    </tr>
    <tr>
      <th>Account</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MSTICAlertsWin1\MSTICAdmin</th>
      <td>3</td>
    </tr>
    <tr>
      <th>NT AUTHORITY\SYSTEM</th>
      <td>14</td>
    </tr>
    <tr>
      <th>Window Manager\DWM-1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Window Manager\DWM-2</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="iterating-over-groups-groupby-returns-an-iterable">
<h2>Iterating over groups - <code class="docutils literal notranslate"><span class="pre">groupby</span></code> returns an iterable<a class="headerlink" href="#iterating-over-groups-groupby-returns-an-iterable" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numbers of rows in each group:&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">logon_group</span> <span class="ow">in</span> <span class="n">logons_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Account&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">logon_group</span><span class="p">),</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="n">logon_group</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Numbers of rows in each group:
MSTICAlertsWin1\MSTICAdmin &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt; size (3, 15)
NT AUTHORITY\SYSTEM &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt; size (14, 15)
Window Manager\DWM-1 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt; size (2, 15)
Window Manager\DWM-2 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt; size (1, 15)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Collect individual group DFs in dictionary&quot;</span><span class="p">)</span>
<span class="n">df_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">df</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">logons_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Account&quot;</span><span class="p">)}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">df_dict</span><span class="p">[</span><span class="s2">&quot;NT AUTHORITY\SYSTEM&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collect individual group DFs in dictionary
dict_keys([&#39;MSTICAlertsWin1\\MSTICAdmin&#39;, &#39;NT AUTHORITY\\SYSTEM&#39;, &#39;Window Manager\\DWM-1&#39;, &#39;Window Manager\\DWM-2&#39;])
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>MSTICAlertsWin1</td>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>0</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
    <tr>
      <th>46</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-10 05:10:54.300</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-10 05:10:54.300</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="grouping-with-multiple-aggregation-functions">
<h2>Grouping with Multiple aggregation functions<a class="headerlink" href="#grouping-with-multiple-aggregation-functions" title="Permalink to this headline">#</a></h2>
<p style="font-family:consolas; font-size:15pt; color:green">
.agg({"Column_1": "agg_func", "Column_2": "agg_func"})
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="p">(</span>
    <span class="n">logons_df</span><span class="p">[[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="s2">&quot;LogonType&quot;</span><span class="p">,</span> <span class="s2">&quot;Account&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Account&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;LogonType&quot;</span><span class="p">:</span> <span class="s2">&quot;nunique&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">:</span> <span class="s2">&quot;LastTime&quot;</span><span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LastTime</th>
      <th>LogonType</th>
    </tr>
    <tr>
      <th>Account</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MSTICAlertsWin1\MSTICAdmin</th>
      <td>2019-02-15 03:56:57.070</td>
      <td>2</td>
    </tr>
    <tr>
      <th>NT AUTHORITY\SYSTEM</th>
      <td>2019-02-15 06:51:51.500</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Window Manager\DWM-1</th>
      <td>2019-02-14 04:20:54.773</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Window Manager\DWM-2</th>
      <td>2019-02-12 22:22:21.240</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="grouping-with-multiple-columns">
<h2>Grouping with multiple columns<a class="headerlink" href="#grouping-with-multiple-columns" title="Permalink to this headline">#</a></h2>
<p style="font-family:consolas; font-size:15pt; color:green">
.groupby(["Account", "LogonType"])
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">logons_full_df</span><span class="p">[[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="s2">&quot;EventID&quot;</span><span class="p">,</span> <span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;LogonType&quot;</span><span class="p">]]</span>      <span class="c1"># DF input fields</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;LogonType&quot;</span><span class="p">])</span>                                        <span class="c1"># Grouping fields</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;EventID&quot;</span><span class="p">:</span> <span class="s2">&quot;count&quot;</span><span class="p">})</span>                        <span class="c1"># aggregate operations</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">:</span> <span class="s2">&quot;LastTime&quot;</span><span class="p">,</span> <span class="s2">&quot;EventID&quot;</span><span class="p">:</span> <span class="s2">&quot;Count&quot;</span><span class="p">})</span>        <span class="c1"># Rename output</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>LastTime</th>
      <th>Count</th>
    </tr>
    <tr>
      <th>Account</th>
      <th>LogonType</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">MSTICAlertsWin1\MSTICAdmin</th>
      <th>3</th>
      <td>2019-02-15 03:57:00.207</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-02-14 11:51:37.603</td>
      <td>8</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2019-02-15 03:57:02.593</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">MSTICAlertsWin1\ian</th>
      <th>2</th>
      <td>2019-02-12 20:29:51.030</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-02-15 03:56:34.440</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-02-12 20:41:17.310</td>
      <td>1</td>
    </tr>
    <tr>
      <th>NT AUTHORITY\IUSR</th>
      <th>5</th>
      <td>2019-02-14 04:20:56.110</td>
      <td>2</td>
    </tr>
    <tr>
      <th>NT AUTHORITY\LOCAL SERVICE</th>
      <th>5</th>
      <td>2019-02-14 04:20:54.803</td>
      <td>2</td>
    </tr>
    <tr>
      <th>NT AUTHORITY\NETWORK SERVICE</th>
      <th>5</th>
      <td>2019-02-14 04:20:54.630</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NT AUTHORITY\SYSTEM</th>
      <th>0</th>
      <td>2019-02-14 04:20:54.370</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019-02-15 11:51:37.597</td>
      <td>120</td>
    </tr>
    <tr>
      <th>Window Manager\DWM-1</th>
      <th>2</th>
      <td>2019-02-14 04:20:54.773</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Window Manager\DWM-2</th>
      <th>2</th>
      <td>2019-02-15 03:57:01.903</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="using-pd-grouper-to-group-by-time-interval">
<h2>Using pd.Grouper to group by time interval<a class="headerlink" href="#using-pd-grouper-to-group-by-time-interval" title="Permalink to this headline">#</a></h2>
<p style="font-family:consolas; font-size:15pt; color:green">
.groupby(["Account", pd.Grouper(key="TimeGenerated", freq="1D")])
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">logons_full_df</span><span class="p">[[</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="s2">&quot;EventID&quot;</span><span class="p">,</span> <span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;LogonType&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;1D&quot;</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;EventID&quot;</span><span class="p">:</span> <span class="s2">&quot;count&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;TimeGenerated&quot;</span><span class="p">:</span> <span class="s2">&quot;LastTime&quot;</span><span class="p">,</span> <span class="s2">&quot;EventID&quot;</span><span class="p">:</span> <span class="s2">&quot;Count&quot;</span><span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>LastTime</th>
      <th>Count</th>
    </tr>
    <tr>
      <th>Account</th>
      <th>TimeGenerated</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">MSTICAlertsWin1\MSTICAdmin</th>
      <th>2019-02-09</th>
      <td>2019-02-09 23:26:47.700</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-02-11</th>
      <td>2019-02-11 22:47:53.750</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2019-02-12</th>
      <td>2019-02-12 20:19:44.767</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2019-02-13</th>
      <td>2019-02-13 23:07:23.823</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-02-14</th>
      <td>2019-02-14 11:51:37.603</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-02-15</th>
      <td>2019-02-15 03:57:02.593</td>
      <td>3</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">MSTICAlertsWin1\ian</th>
      <th>2019-02-12</th>
      <td>2019-02-12 20:41:17.310</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2019-02-13</th>
      <td>2019-02-13 00:57:37.187</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2019-02-15</th>
      <td>2019-02-15 03:56:34.440</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NT AUTHORITY\IUSR</th>
      <th>2019-02-12</th>
      <td>2019-02-12 04:40:12.360</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-02-14</th>
      <td>2019-02-14 04:20:56.110</td>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NT AUTHORITY\LOCAL SERVICE</th>
      <th>2019-02-12</th>
      <td>2019-02-12 04:40:04.573</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-02-14</th>
      <td>2019-02-14 04:20:54.803</td>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NT AUTHORITY\NETWORK SERVICE</th>
      <th>2019-02-12</th>
      <td>2019-02-12 04:40:04.207</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-02-14</th>
      <td>2019-02-14 04:20:54.630</td>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">NT AUTHORITY\SYSTEM</th>
      <th>2019-02-09</th>
      <td>2019-02-09 12:35:51.683</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-02-10</th>
      <td>2019-02-10 21:47:21.503</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2019-02-11</th>
      <td>2019-02-11 09:59:02.593</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-02-12</th>
      <td>2019-02-12 22:20:59.200</td>
      <td>53</td>
    </tr>
    <tr>
      <th>2019-02-13</th>
      <td>2019-02-13 22:08:46.537</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2019-02-14</th>
      <td>2019-02-14 14:51:37.637</td>
      <td>33</td>
    </tr>
    <tr>
      <th>2019-02-15</th>
      <td>2019-02-15 11:51:37.597</td>
      <td>11</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Window Manager\DWM-1</th>
      <th>2019-02-12</th>
      <td>2019-02-12 04:40:04.483</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-02-14</th>
      <td>2019-02-14 04:20:54.773</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Window Manager\DWM-2</th>
      <th>2019-02-12</th>
      <td>2019-02-12 22:22:21.240</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2019-02-15</th>
      <td>2019-02-15 03:57:01.903</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-adding-columns-adding-and-removing-columns-a">
<h1><a style="border: solid; padding:5pt; color:black; background-color:#90CAF9" name="adding-columns">Adding and removing columns</a><a class="headerlink" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-adding-columns-adding-and-removing-columns-a" title="Permalink to this headline">#</a></h1>
<p style="font-family:consolas; font-size:15pt; color:green">
df[<i>column_name</i>] = <i>expr</i>
</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span> <span class="o">=</span> <span class="n">logons_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Adding a static value</span>
<span class="n">new_df</span><span class="p">[</span><span class="s2">&quot;StaticValue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;A logon&quot;</span>

<span class="c1"># Extracting a substring (there are several ways to do this)</span>
<span class="n">new_df</span><span class="p">[</span><span class="s2">&quot;NTDomain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">Account</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Transforming using an accessor</span>
<span class="n">new_df</span><span class="p">[</span><span class="s2">&quot;DayOfWeek&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">TimeGenerated</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span>

<span class="c1"># Arithmetic calculations</span>
<span class="n">new_df</span><span class="p">[</span><span class="s2">&quot;BigEventID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">EventID</span> <span class="o">*</span> <span class="mi">1000000</span>
<span class="n">new_df</span><span class="p">[</span><span class="s2">&quot;SameTimeTomorrow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">TimeGenerated</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1D&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Old&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">logons_df</span><span class="p">[[</span><span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="s2">&quot;EventID&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New&quot;</span><span class="p">)</span>
<span class="n">new_df</span><span class="p">[[</span>
    <span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="s2">&quot;StaticValue&quot;</span><span class="p">,</span> <span class="s2">&quot;NTDomain&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">,</span> <span class="s2">&quot;BigEventID&quot;</span><span class="p">,</span> <span class="s2">&quot;SameTimeTomorrow&quot;</span>
<span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Old
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>TimeGenerated</th>
      <th>EventID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>4624</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>4624</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>4624</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>4624</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>4624</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>New
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>TimeGenerated</th>
      <th>StaticValue</th>
      <th>NTDomain</th>
      <th>DayOfWeek</th>
      <th>BigEventID</th>
      <th>SameTimeTomorrow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>A logon</td>
      <td>NT AUTHORITY</td>
      <td>Tuesday</td>
      <td>4624000000</td>
      <td>2019-02-13 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>A logon</td>
      <td>NT AUTHORITY</td>
      <td>Tuesday</td>
      <td>4624000000</td>
      <td>2019-02-13 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>A logon</td>
      <td>NT AUTHORITY</td>
      <td>Tuesday</td>
      <td>4624000000</td>
      <td>2019-02-13 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>A logon</td>
      <td>NT AUTHORITY</td>
      <td>Tuesday</td>
      <td>4624000000</td>
      <td>2019-02-13 04:40:11.620</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>A logon</td>
      <td>MSTICAlertsWin1</td>
      <td>Monday</td>
      <td>4624000000</td>
      <td>2019-02-12 22:47:53.750</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="assign-function">
<h2><code class="docutils literal notranslate"><span class="pre">assign</span></code> function<a class="headerlink" href="#assign-function" title="Permalink to this headline">#</a></h2>
<p>Note this introduces a new column to the <strong>output</strong> - it does not update the dataframe.</p>
<p style="font-family:consolas; font-size:15pt; color:green">
df.assign(NewColumn=<i>expr</i>)
</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">new_df</span><span class="p">[[</span><span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">,</span> <span class="s2">&quot;SameTimeTomorrow&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">SameTimeLastWeek</span><span class="o">=</span><span class="n">new_df</span><span class="o">.</span><span class="n">TimeGenerated</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1W&quot;</span><span class="p">),</span>
        <span class="n">When</span><span class="o">=</span><span class="n">new_df</span><span class="o">.</span><span class="n">StaticValue</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">new_df</span><span class="o">.</span><span class="n">DayOfWeek</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; happened on &quot;</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>TimeGenerated</th>
      <th>DayOfWeek</th>
      <th>SameTimeTomorrow</th>
      <th>SameTimeLastWeek</th>
      <th>When</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>Tuesday</td>
      <td>2019-02-13 04:44:10.343</td>
      <td>2019-02-05 04:44:10.343</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>Tuesday</td>
      <td>2019-02-13 04:40:11.867</td>
      <td>2019-02-05 04:40:11.867</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>Tuesday</td>
      <td>2019-02-13 04:40:03.870</td>
      <td>2019-02-05 04:40:03.870</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>Tuesday</td>
      <td>2019-02-13 04:40:11.620</td>
      <td>2019-02-05 04:40:11.620</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>Monday</td>
      <td>2019-02-12 22:47:53.750</td>
      <td>2019-02-04 22:47:53.750</td>
      <td>A logon happened on Monday</td>
    </tr>
    <tr>
      <th>36</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-11 09:58:48.773</td>
      <td>Monday</td>
      <td>2019-02-12 09:58:48.773</td>
      <td>2019-02-04 09:58:48.773</td>
      <td>A logon happened on Monday</td>
    </tr>
    <tr>
      <th>46</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-10 05:10:54.300</td>
      <td>Sunday</td>
      <td>2019-02-11 05:10:54.300</td>
      <td>2019-02-03 05:10:54.300</td>
      <td>A logon happened on Sunday</td>
    </tr>
    <tr>
      <th>68</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-14 04:21:37.637</td>
      <td>Thursday</td>
      <td>2019-02-15 04:21:37.637</td>
      <td>2019-02-07 04:21:37.637</td>
      <td>A logon happened on Thursday</td>
    </tr>
    <tr>
      <th>70</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-14 04:20:54.370</td>
      <td>Thursday</td>
      <td>2019-02-15 04:20:54.370</td>
      <td>2019-02-07 04:20:54.370</td>
      <td>A logon happened on Thursday</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Window Manager\DWM-1</td>
      <td>2019-02-14 04:20:54.773</td>
      <td>Thursday</td>
      <td>2019-02-15 04:20:54.773</td>
      <td>2019-02-07 04:20:54.773</td>
      <td>A logon happened on Thursday</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Window Manager\DWM-1</td>
      <td>2019-02-14 04:20:54.773</td>
      <td>Thursday</td>
      <td>2019-02-15 04:20:54.773</td>
      <td>2019-02-07 04:20:54.773</td>
      <td>A logon happened on Thursday</td>
    </tr>
    <tr>
      <th>93</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-13 20:11:41.150</td>
      <td>Wednesday</td>
      <td>2019-02-14 20:11:41.150</td>
      <td>2019-02-06 20:11:41.150</td>
      <td>A logon happened on Wednesday</td>
    </tr>
    <tr>
      <th>100</th>
      <td>Window Manager\DWM-2</td>
      <td>2019-02-12 22:22:21.240</td>
      <td>Tuesday</td>
      <td>2019-02-13 22:22:21.240</td>
      <td>2019-02-05 22:22:21.240</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>110</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 21:20:35.003</td>
      <td>Tuesday</td>
      <td>2019-02-13 21:20:35.003</td>
      <td>2019-02-05 21:20:35.003</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>111</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 21:05:29.523</td>
      <td>Tuesday</td>
      <td>2019-02-13 21:05:29.523</td>
      <td>2019-02-05 21:05:29.523</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>130</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 20:09:16.550</td>
      <td>Tuesday</td>
      <td>2019-02-13 20:09:16.550</td>
      <td>2019-02-05 20:09:16.550</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>135</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 20:30:34.990</td>
      <td>Tuesday</td>
      <td>2019-02-13 20:30:34.990</td>
      <td>2019-02-05 20:30:34.990</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>142</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 20:19:52.520</td>
      <td>Tuesday</td>
      <td>2019-02-13 20:19:52.520</td>
      <td>2019-02-05 20:19:52.520</td>
      <td>A logon happened on Tuesday</td>
    </tr>
    <tr>
      <th>146</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-15 06:51:51.500</td>
      <td>Friday</td>
      <td>2019-02-16 06:51:51.500</td>
      <td>2019-02-08 06:51:51.500</td>
      <td>A logon happened on Friday</td>
    </tr>
    <tr>
      <th>155</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-15 03:56:57.070</td>
      <td>Friday</td>
      <td>2019-02-16 03:56:57.070</td>
      <td>2019-02-08 03:56:57.070</td>
      <td>A logon happened on Friday</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="drop-columns">
<h3>Drop columns<a class="headerlink" href="#drop-columns" title="Permalink to this headline">#</a></h3>
<p style="font-family:consolas; font-size:15pt; color:green">
df.drop(columns=[<i>column_list</i>])<br><br>
df.drop(columns=[<i>column_list</i>], inplace=True) <i># Beware!</i><br>
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">new_df</span><span class="p">[[</span><span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="s2">&quot;TimeGenerated&quot;</span><span class="p">,</span> <span class="s2">&quot;StaticValue&quot;</span><span class="p">,</span> <span class="s2">&quot;NTDomain&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">head</span><span class="p">()</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NTDomain&quot;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>TimeGenerated</th>
      <th>StaticValue</th>
      <th>DayOfWeek</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>A logon</td>
      <td>Tuesday</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>A logon</td>
      <td>Tuesday</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:03.870</td>
      <td>A logon</td>
      <td>Tuesday</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>2019-02-12 04:40:11.620</td>
      <td>A logon</td>
      <td>Tuesday</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAlertsWin1\MSTICAdmin</td>
      <td>2019-02-11 22:47:53.750</td>
      <td>A logon</td>
      <td>Monday</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="some-other-quick-ways-of-filtering-out-in-columns">
<h2>Some other quick ways of filtering out (in) columns<a class="headerlink" href="#some-other-quick-ways-of-filtering-out-in-columns" title="Permalink to this headline">#</a></h2>
<p style="font-family:consolas; font-size:15pt; color:green">
.filter(regex="Target.*", axis=1)
</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Account&#39;, &#39;EventID&#39;, &#39;TimeGenerated&#39;, &#39;Computer&#39;, &#39;SubjectUserName&#39;,
       &#39;SubjectDomainName&#39;, &#39;SubjectUserSid&#39;, &#39;TargetUserName&#39;,
       &#39;TargetDomainName&#39;, &#39;TargetUserSid&#39;, &#39;TargetLogonId&#39;, &#39;LogonType&#39;,
       &#39;IpAddress&#39;, &#39;WorkstationName&#39;, &#39;TimeCreatedUtc&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s2">&quot;Target.*&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>9</th>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>12</th>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>29</th>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc54c7b9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Filter by Data Type</p>
<p style="font-family:consolas; font-size:15pt; color:green">
.select_dtypes(include="datetime")
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logons_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># also &quot;number&quot;, &quot;object&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TimeGenerated</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>2019-02-12 04:44:10.343</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2019-02-12 04:40:11.867</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2019-02-12 04:40:03.870</td>
      <td>2019-02-12 04:40:03.870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2019-02-12 04:40:11.620</td>
      <td>2019-02-12 04:40:11.620</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2019-02-11 22:47:53.750</td>
      <td>2019-02-11 22:47:53.750</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-simple-joins-simple-joins-a">
<h1><a style="border: solid; padding:5pt; color:black; background-color:#90CAF9" name="simple-joins">Simple Joins</a><a class="headerlink" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-simple-joins-simple-joins-a" title="Permalink to this headline">#</a></h1>
<p style="font-family:consolas; font-size:15pt; color:green">
pd.concat([<i>df_list</i>])
</p>
<p>(relational joins tomorrow)</p>
<div class="section" id="concatenating-dfs">
<h2>Concatenating DFs<a class="headerlink" href="#concatenating-dfs" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract two DFs from subset of rows</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">logons_full_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">logons_full_df</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">120</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of DFs (rows, cols)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;df1:&quot;</span><span class="p">,</span> <span class="n">df1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;df2:&quot;</span><span class="p">,</span> <span class="n">df2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensions of DFs (rows, cols)
df1: (10, 15) df2: (20, 15)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:43:56.327</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:43:56.327</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:44:10.343</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:44:10.343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 04:40:11.867</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 04:40:11.867</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>117</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:49:11.777</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:49:11.777</td>
    </tr>
    <tr>
      <th>118</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:39:15.897</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:39:15.897</td>
    </tr>
    <tr>
      <th>119</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 20:11:06.790</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 20:11:06.790</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="joining-rows">
<h3>Joining rows<a class="headerlink" href="#joining-rows" title="Permalink to this headline">#</a></h3>
<p style="font-family:consolas; font-size:15pt; color:green">
pd.concat([df_1, df_2...])
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">joined_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">joined_df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(30, 15)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>117</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:49:11.777</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:49:11.777</td>
    </tr>
    <tr>
      <th>118</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:39:15.897</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:39:15.897</td>
    </tr>
    <tr>
      <th>119</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 20:11:06.790</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 20:11:06.790</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joined_df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9, 100, 101, 102,
            103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115,
            116, 117, 118, 119],
           dtype=&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
<div class="section" id="ignore-index-true-causes-python-to-regenerate-a-new-index">
<h4><code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code> causes Python to regenerate a new index<a class="headerlink" href="#ignore-index-true-causes-python-to-regenerate-a-new-index" title="Permalink to this headline">#</a></h4>
<p style="font-family:consolas; font-size:15pt; color:green">
pd.concat(df_list, <b>ignore_index=True</b>)
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">]</span>
<span class="n">joined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">joined_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">joined_df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(30, 15)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>EventID</th>
      <th>TimeGenerated</th>
      <th>Computer</th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
      <th>LogonType</th>
      <th>IpAddress</th>
      <th>WorkstationName</th>
      <th>TimeCreatedUtc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:49:11.777</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:49:11.777</td>
    </tr>
    <tr>
      <th>28</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 21:39:15.897</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 21:39:15.897</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NT AUTHORITY\SYSTEM</td>
      <td>4624</td>
      <td>2019-02-12 20:11:06.790</td>
      <td>MSTICAlertsWin1</td>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
      <td>5</td>
      <td>-</td>
      <td>-</td>
      <td>2019-02-12 20:11:06.790</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joined_df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=30, step=1)
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="joining-columns-horizontal">
<h2>Joining columns (horizontal)<a class="headerlink" href="#joining-columns-horizontal" title="Permalink to this headline">#</a></h2>
<p style="font-family:consolas; font-size:15pt; color:green">
pd.concat([df_1, df_2...], <b>axis="columns"</b>)
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_col_1</span> <span class="o">=</span> <span class="n">logons_full_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s2">&quot;Subject.*&quot;</span><span class="p">)</span>
<span class="n">df_col_2</span> <span class="o">=</span> <span class="n">logons_full_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s2">&quot;Target.*&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_col_1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">df_col_2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_col_1</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_col_2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10, 3) (12, 4)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc90e957</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc90ea44</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc912d62</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc913737</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_col_1</span><span class="p">,</span> <span class="n">df_col_2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SubjectUserName</th>
      <th>SubjectDomainName</th>
      <th>SubjectUserSid</th>
      <th>TargetUserName</th>
      <th>TargetDomainName</th>
      <th>TargetUserSid</th>
      <th>TargetLogonId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc90e957</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc90ea44</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc912d62</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-</td>
      <td>-</td>
      <td>S-1-0-0</td>
      <td>MSTICAdmin</td>
      <td>MSTICAlertsWin1</td>
      <td>S-1-5-21-996632719-2361334927-4038480536-500</td>
      <td>0xc913737</td>
    </tr>
    <tr>
      <th>5</th>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>9</th>
      <td>MSTICAlertsWin1$</td>
      <td>WORKGROUP</td>
      <td>S-1-5-18</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>IUSR</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-17</td>
      <td>0x3e3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SYSTEM</td>
      <td>NT AUTHORITY</td>
      <td>S-1-5-18</td>
      <td>0x3e7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-stats-101-statistics-101-with-pandas-a">
<h1><a style="border: solid; padding:5pt; color:black; background-color:#90CAF9" name="stats-101">Statistics 101 with Pandas</a><a class="headerlink" href="#a-style-border-solid-padding-5pt-color-black-background-color-90caf9-name-stats-101-statistics-101-with-pandas-a" title="Permalink to this headline">#</a></h1>
<p>In this part of the workshop we will use a statistical approach to perform data analysis. There are two basic types of statistical analysis: <em>Descriptive</em> and <em>Inferential</em>. During this workshop, we will focus on <strong>Descriptive Analysis</strong>.</p>
<p>For the purpose of this section, we will use a network compound Security Dataset that you can find <a class="reference external" href="https://github.com/OTRF/Security-Datasets/tree/master/datasets/compound/apt29/day1/zeek">here</a>. Therefore, let’s start by importing the dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># Opeing the log file</span>
<span class="n">zeek_data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/combined_zeek.log&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="c1"># Creating a list of dictionaries</span>
<span class="n">zeek_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="nb">dict</span> <span class="ow">in</span> <span class="n">zeek_data</span><span class="p">:</span>
    <span class="n">zeek_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="nb">dict</span><span class="p">))</span>
<span class="c1"># Closing the log file</span>
<span class="n">zeek_data</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># Creating a dataframe</span>
<span class="n">zeek_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">zeek_list</span><span class="p">)</span>
<span class="n">zeek_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>@stream</th>
      <th>@system</th>
      <th>@proc</th>
      <th>ts</th>
      <th>uid</th>
      <th>id_orig_h</th>
      <th>id_orig_p</th>
      <th>id_resp_h</th>
      <th>id_resp_p</th>
      <th>proto</th>
      <th>...</th>
      <th>is_64bit</th>
      <th>uses_aslr</th>
      <th>uses_dep</th>
      <th>uses_code_integrity</th>
      <th>uses_seh</th>
      <th>has_import_table</th>
      <th>has_export_table</th>
      <th>has_cert_table</th>
      <th>has_debug_data</th>
      <th>section_names</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>conn</td>
      <td>bobs.bigwheel.local</td>
      <td>zeek</td>
      <td>1.588205e+09</td>
      <td>Cvf4XX17hSAgXDdGEd</td>
      <td>10.0.1.6</td>
      <td>54243.0</td>
      <td>10.0.0.4</td>
      <td>53.0</td>
      <td>udp</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>conn</td>
      <td>bobs.bigwheel.local</td>
      <td>zeek</td>
      <td>1.588205e+09</td>
      <td>CJ21Le4zsTUcyKKi98</td>
      <td>10.0.1.6</td>
      <td>56880.0</td>
      <td>10.0.0.4</td>
      <td>445.0</td>
      <td>tcp</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>conn</td>
      <td>bobs.bigwheel.local</td>
      <td>zeek</td>
      <td>1.588205e+09</td>
      <td>CnOP7t1eGGHf6LFfuk</td>
      <td>10.0.1.6</td>
      <td>65108.0</td>
      <td>10.0.0.4</td>
      <td>53.0</td>
      <td>udp</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>conn</td>
      <td>bobs.bigwheel.local</td>
      <td>zeek</td>
      <td>1.588205e+09</td>
      <td>CvxbPE3MuO7boUdSc8</td>
      <td>10.0.1.6</td>
      <td>138.0</td>
      <td>10.0.1.255</td>
      <td>138.0</td>
      <td>udp</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>conn</td>
      <td>bobs.bigwheel.local</td>
      <td>zeek</td>
      <td>1.588205e+09</td>
      <td>CuRbE21APSQo2qd6rk</td>
      <td>10.0.1.6</td>
      <td>123.0</td>
      <td>10.0.0.4</td>
      <td>123.0</td>
      <td>udp</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 148 columns</p>
</div></div></div>
</div>
<div class="section" id="data-types">
<h2>Data Types<a class="headerlink" href="#data-types" title="Permalink to this headline">#</a></h2>
<p>Before we start reviewing different descriptive analysis techniques, it is important to understand the type of data we are collecting in order to apply these techniques accordingly.</p>
<div class="section" id="numerical-data">
<h3><strong>Numerical</strong> data<a class="headerlink" href="#numerical-data" title="Permalink to this headline">#</a></h3>
<p>This type of data represent the output of <strong>counting</strong> or <strong>measuring</strong> activities. Numerical data values are usually represented by <strong>numbers</strong>, and arithmetic calculations such as addition or subtraction do add context to our analysis.</p>
<ul class="simple">
<li><p>The quantity of <strong>network packets</strong> transferred over our network is a good example of numerical data generated by counting activities. This type of numerical data is also known as <strong>discrete</strong> data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[[</span><span class="s1">&#39;service&#39;</span><span class="p">,</span><span class="s1">&#39;id_orig_h&#39;</span><span class="p">,</span><span class="s1">&#39;orig_pkts&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>service</th>
      <th>id_orig_h</th>
      <th>orig_pkts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>dns</td>
      <td>10.0.1.6</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gssapi,smb,krb</td>
      <td>10.0.1.6</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>dns</td>
      <td>10.0.1.6</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>10.0.1.6</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>10.0.1.6</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The network <strong>connection duration</strong> is a good example of numerical data generated by measuring activities. This type of numerical data is also known as <strong>continuous</strong> data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[[</span><span class="s1">&#39;service&#39;</span><span class="p">,</span><span class="s1">&#39;id_orig_h&#39;</span><span class="p">,</span><span class="s1">&#39;duration&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>service</th>
      <th>id_orig_h</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>dns</td>
      <td>10.0.1.6</td>
      <td>0.001528</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gssapi,smb,krb</td>
      <td>10.0.1.6</td>
      <td>10.761077</td>
    </tr>
    <tr>
      <th>2</th>
      <td>dns</td>
      <td>10.0.1.6</td>
      <td>0.001599</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>10.0.1.6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>10.0.1.6</td>
      <td>0.003069</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="categorical-data">
<h3><strong>Categorical</strong> data<a class="headerlink" href="#categorical-data" title="Permalink to this headline">#</a></h3>
<p>This type of data represents <strong>categories</strong> or <strong>qualities</strong>. Categorical data values are usually described using characters or <strong>strings of characters</strong>. Moreover, categorical data values can also be represented by <strong>numbers</strong>. Unlike numerical data, arithmetic operations such as addition or subtraction do not add any extra context.</p>
<ul class="simple">
<li><p>The <strong>network protocol</strong> used creating a network connection is a good example of categorical data that describes a category, and does not give us any sense of order (We cannot compare among categories). This type of categorical data is also known as <strong>nominal</strong> data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[[</span><span class="s1">&#39;service&#39;</span><span class="p">,</span><span class="s1">&#39;id_orig_h&#39;</span><span class="p">,</span><span class="s1">&#39;proto&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>service</th>
      <th>id_orig_h</th>
      <th>proto</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>dns</td>
      <td>10.0.1.6</td>
      <td>udp</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gssapi,smb,krb</td>
      <td>10.0.1.6</td>
      <td>tcp</td>
    </tr>
    <tr>
      <th>2</th>
      <td>dns</td>
      <td>10.0.1.6</td>
      <td>udp</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>10.0.1.6</td>
      <td>udp</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>10.0.1.6</td>
      <td>udp</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Another type of categorical data is known as <strong>ordinal</strong> data. Unlike nominal data, this type of data gives a sense of order (We can compare among categories). A good example of this type of data is the <strong>Integrity Level</strong> of a process: Low, Medium, High, System. Using the integrity level field as a reference, we can organize our processes from lower to high integrity level (Access Rights).</p></li>
</ul>
</div>
</div>
<div class="section" id="descriptive-analysis-for-categorical-data">
<h2>Descriptive Analysis for Categorical data<a class="headerlink" href="#descriptive-analysis-for-categorical-data" title="Permalink to this headline">#</a></h2>
<div class="section" id="categorical-data-types-in-pandas">
<h3><strong>Categorical data types</strong> in Pandas<a class="headerlink" href="#categorical-data-types-in-pandas" title="Permalink to this headline">#</a></h3>
<p>Pandas uses the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/categorical.html">category</a></strong> data type to represent both nominal and ordinal data. Let’s check the current type of data for the <strong>protocol</strong> field we reviewed previously:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[[</span><span class="s1">&#39;proto&#39;</span><span class="p">,</span><span class="s1">&#39;service&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>proto      object
service    object
dtype: object
</pre></div>
</div>
</div>
</div>
<p>As you can see in the previous cell, the current type of data for <strong>protocol</strong> is string. We can change the type of data to <strong>cateogry</strong> using the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.astype.html">astype</a></strong> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span> <span class="o">=</span> <span class="n">zeek_df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;proto&#39;</span><span class="p">:</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span><span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;category&#39;</span><span class="p">})</span>
<span class="n">zeek_df</span><span class="p">[[</span><span class="s1">&#39;proto&#39;</span><span class="p">,</span><span class="s1">&#39;service&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>proto      category
service    category
dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="describe-method">
<h3><strong>Describe Method</strong><a class="headerlink" href="#describe-method" title="Permalink to this headline">#</a></h3>
<p>Using the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.describe.html">describe</a></strong> method on categorical data will calculate the following statistics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     521
unique     17
top       ssl
freq      378
Name: service, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="frequency-of-values">
<h3><strong>Frequency of Values</strong><a class="headerlink" href="#frequency-of-values" title="Permalink to this headline">#</a></h3>
<p>We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">groupby</a></strong>, <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.size.html">size</a></strong> and <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sort_values.html">sort_values</a></strong> methods to calculate the frequency of network connections by network service.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;service&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>service
ssl                           378
dns                            39
krb_tcp                        25
dce_rpc                        20
gssapi                         12
krbtgt/DMEVALS.LOCAL            9
krb,smb,gssapi                  7
krbtgt/dmevals                  6
gssapi,smb,krb                  6
http                            6
cifs/NASHUA                     4
host/nashua.dmevals.local       3
krb,smb,dce_rpc,gssapi          2
gssapi,smb,krb,dce_rpc          1
cifs/NEWYORK                    1
ldap/NEWYORK.dmevals.local      1
HTTP/NASHUA                     1
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="central-tendency">
<h3><strong>Central Tendency</strong><a class="headerlink" href="#central-tendency" title="Permalink to this headline">#</a></h3>
<p>Central tendency metrics are values that intent to describe a whole group of values. One example of central tendency metric for categorical data is the mode or most frequent value. We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mode.html">mode</a></strong> method to calculate it.</p>
<p>Another central tendency metric that we could use with categorical data is the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.median.html">median</a></strong>, but we can use it only with <strong>ordinal</strong> data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    ssl
Name: service, dtype: category
Categories (17, object): [&#39;HTTP/NASHUA&#39;, &#39;cifs/NASHUA&#39;, &#39;cifs/NEWYORK&#39;, &#39;dce_rpc&#39;, ..., &#39;krbtgt/DMEVALS.LOCAL&#39;, &#39;krbtgt/dmevals&#39;, &#39;ldap/NEWYORK.dmevals.local&#39;, &#39;ssl&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="correlation">
<h3><strong>Correlation</strong><a class="headerlink" href="#correlation" title="Permalink to this headline">#</a></h3>
<p>We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.crosstab.html">crosstab</a></strong> method to create a crossed table with two or more factors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">],</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>proto</th>
      <th>tcp</th>
      <th>udp</th>
    </tr>
    <tr>
      <th>service</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>dce_rpc</th>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>dns</th>
      <td>0</td>
      <td>39</td>
    </tr>
    <tr>
      <th>gssapi</th>
      <td>12</td>
      <td>0</td>
    </tr>
    <tr>
      <th>gssapi,smb,krb</th>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>gssapi,smb,krb,dce_rpc</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>http</th>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>krb,smb,dce_rpc,gssapi</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>krb,smb,gssapi</th>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>krb_tcp</th>
      <td>25</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ssl</th>
      <td>378</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="descriptive-analysis-for-numerical-data">
<h2>Descriptive Analysis for Numerical data<a class="headerlink" href="#descriptive-analysis-for-numerical-data" title="Permalink to this headline">#</a></h2>
<div class="section" id="numerical-data-type-in-pandas">
<h3><strong>Numerical data type</strong> in Pandas<a class="headerlink" href="#numerical-data-type-in-pandas" title="Permalink to this headline">#</a></h3>
<p>Pandas uses the <em>numeric</em> data type to represent both discrete and continuous data. The numeric data type includes <strong><a class="reference external" href="https://docs.python.org/3/library/functions.html#int">integer</a></strong> and <strong><a class="reference external" href="https://docs.python.org/3/library/functions.html#float">float</a></strong> Python data types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_data</span> <span class="o">=</span> <span class="n">zeek_df</span><span class="p">[[</span><span class="s1">&#39;duration&#39;</span><span class="p">,</span><span class="s1">&#39;orig_bytes&#39;</span><span class="p">,</span><span class="s1">&#39;orig_pkts&#39;</span><span class="p">,</span><span class="s1">&#39;resp_bytes&#39;</span><span class="p">,</span><span class="s1">&#39;resp_pkts&#39;</span><span class="p">]]</span>
<span class="n">numerical_data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>duration      float64
orig_bytes    float64
orig_pkts     float64
resp_bytes    float64
resp_pkts     float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.astype.html">astype</a></strong> method to convert the numeric data type. For example, let’s change the data type for <em>orig_pkts</em> and <em>resp_pkts</em> to <strong>integer</strong>. We are using the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/integer_na.html">Nullable Integer</a> data type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_data_updated</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;orig_pkts&#39;</span><span class="p">:</span><span class="s1">&#39;Int64&#39;</span><span class="p">,</span><span class="s1">&#39;resp_pkts&#39;</span><span class="p">:</span> <span class="s1">&#39;Int64&#39;</span><span class="p">},</span> <span class="n">errors</span> <span class="o">=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">numerical_data_updated</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>duration      float64
orig_bytes    float64
orig_pkts       Int64
resp_bytes    float64
resp_pkts       Int64
dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3><strong>Describe Method</strong><a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Using the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.describe.html">describe</a></strong> method on numerical data will calculate the following statistics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_data_updated</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>duration</th>
      <th>orig_bytes</th>
      <th>orig_pkts</th>
      <th>resp_bytes</th>
      <th>resp_pkts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1025.000000</td>
      <td>5.770000e+02</td>
      <td>613.000000</td>
      <td>5.770000e+02</td>
      <td>613.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.569904</td>
      <td>2.648355e+04</td>
      <td>20.714519</td>
      <td>7.068313e+04</td>
      <td>27.353997</td>
    </tr>
    <tr>
      <th>std</th>
      <td>65.376324</td>
      <td>2.709592e+05</td>
      <td>255.897916</td>
      <td>1.344514e+06</td>
      <td>446.150463</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>1.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>9.970000e+02</td>
      <td>5.000000</td>
      <td>1.514000e+03</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.002708</td>
      <td>9.970000e+02</td>
      <td>7.000000</td>
      <td>1.823000e+03</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.010263</td>
      <td>9.970000e+02</td>
      <td>7.000000</td>
      <td>1.823000e+03</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1901.216208</td>
      <td>4.261160e+06</td>
      <td>6281.000000</td>
      <td>3.185056e+07</td>
      <td>11017.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="id2">
<h3><strong>Frequency of Values</strong><a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>Similar to categorical data, we can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">groupby</a></strong> and <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.size.html">size</a></strong> methods to calculate the frequency of values. However, sometimes the output might not be the desired, especially when working with <em>continuous</em> data. In this case, we might need to group our values into bins.</p>
<p>We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.cut.html">cut</a></strong> method to generate bins with our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a Series with duration data</span>
<span class="n">duration_data</span> <span class="o">=</span> <span class="n">numerical_data_updated</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span>
<span class="c1"># Adding duration_bin column</span>
<span class="n">numerical_data_updated</span><span class="p">[</span><span class="s1">&#39;duration_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">duration_data</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="c1"># Counting network connections per bin (Top 15)</span>
<span class="n">numerical_data_updated</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;duration_bin&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>duration_bin
(-1.901, 3.802]     975
(3.802, 7.605]        3
(7.605, 11.407]      16
(11.407, 15.21]       9
(15.21, 19.012]       0
(19.012, 22.815]      2
(22.815, 26.617]      0
(26.617, 30.419]      0
(30.419, 34.222]      1
(34.222, 38.024]      2
(38.024, 41.827]      0
(41.827, 45.629]      4
(45.629, 49.432]      0
(49.432, 53.234]      0
(53.234, 57.036]      4
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.hist.html">hist</a></strong> method to visualize the distribution of frequencies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtering duration values less or equal to 0.02</span>
<span class="n">numerical_data_updated</span><span class="p">[</span><span class="n">numerical_data_updated</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.02</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;duration&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;AxesSubplot:title={&#39;center&#39;:&#39;duration&#39;}&gt;]], dtype=object)
</pre></div>
</div>
<img alt="../../_images/day1-3-Data-Analysis-with-Pandas Intro_197_1.png" src="../../_images/day1-3-Data-Analysis-with-Pandas Intro_197_1.png" />
</div>
</div>
</div>
<div class="section" id="id3">
<h3><strong>Central Tendency</strong><a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>Central tendency metrics are values that intent to describe a whole group of values.</p>
<p>One example of central tendency metric for numerical data is the mode or most frequent value. We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mode.html">mode</a></strong> method to calculate it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Another central tendency metric that we could use with numerical data is the mean or average value. We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mean.html">mean</a></strong> method to calculate it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.569903998491241
</pre></div>
</div>
</div>
</div>
<p>The mean or average is a good central tendency metric when the distribution of our data is not shifted to one side (Right or Left) or not skewed. If the distribution of our data is skewed, there might be extreme values (Short or Large) in our data that affect the value of our mean. A central tendency metric that is not affected by extreme values is the median. We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.median.html">median</a></strong> method to calculate it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.002707958221435547
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="shape-of-distribution-of-frequencies">
<h3><strong>Shape of Distribution of Frequencies</strong><a class="headerlink" href="#shape-of-distribution-of-frequencies" title="Permalink to this headline">#</a></h3>
<p>In the previous section we mentioned that our data might contain extreme values (Short or Large) that affect the calculation of the mean or average of numerical data. These extreme values could also impact the shape of the distribution of frequencies of our data.</p>
<p>One metric that can help us to describe the shape of the distribution of frequencies is <strong>Kurtosis</strong>. This metric identifies whether the tails of a given distribution contains extreme values. A Kurtosis value greater than 3 might indicate the presence of large outliers. On the other hand, a Kurtosis value less than 3 might indicate the presence of small outliers.</p>
<p>We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.kurtosis.html">kurtosis</a></strong> method to calculate it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>706.6612212729053
</pre></div>
</div>
</div>
</div>
<p>Another metric that can help us to describe the shape of the distribution of frequencies of our data is <strong>Skewness</strong>. This metric identifies if the shape of our distribution of frequencies deviates from the symmetrical bell curve, or normal distribution. In other words, it identifies if the distribution of frequencies is shifted to the right or to the left.</p>
<p>A <strong>negative</strong> value for skewness indicates that our distribution of frequencies is <strong>left skewed</strong> (left tail). On the other hand, a <strong>positive</strong> value for skewness indicates that our distribution of frequencies is <strong>right skewed</strong> (right tail).</p>
<p>We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.skew.html">skew</a></strong> method to calculate it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.313750482239236
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="variability">
<h3><strong>Variability</strong><a class="headerlink" href="#variability" title="Permalink to this headline">#</a></h3>
<p>After calculating central tendency and shape metrics, we identified the presence of potential extreme values. These extreme values are different from most of our data values. This means that there exists variability among our data values.</p>
<p>Let’s start by visually describing the variability of our data using a <strong>box plot</strong>. We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.boxplot.html">boxplot</a></strong> method to graph one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtering duration values less or equal to 0.02</span>
<span class="n">numerical_data_updated</span><span class="p">[</span><span class="n">numerical_data_updated</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.02</span><span class="p">]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;duration&#39;</span><span class="p">,</span> <span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">numerical_data_updated</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    1025.000000
mean        4.569904
std        65.376324
min         0.000000
25%         0.000000
50%         0.002708
75%         0.010263
max      1901.216208
Name: duration, dtype: float64
</pre></div>
</div>
<img alt="../../_images/day1-3-Data-Analysis-with-Pandas Intro_209_1.png" src="../../_images/day1-3-Data-Analysis-with-Pandas Intro_209_1.png" />
</div>
</div>
<p>A very basic metric that we can use to describe the variability in our data is the <strong>Range</strong> of values, which is the difference between the maximum and minimum value. We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.min.html">min</a></strong> and <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.max.html">max</a></strong> methods to calculate the range.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">range</span> <span class="o">=</span> <span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="nb">range</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1901.2162079811096
</pre></div>
</div>
</div>
</div>
<p>Another metric that we can use is the <strong>Interquartile Range (IQR)</strong> of values, which measures the variability or spread of the middle half of our data. We calculate it by subtracting  the first quartile (25%) from the third quartile (75%). We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.quantile.html">quantile</a></strong> method to calculate the first and third quartile of our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iqr</span> <span class="o">=</span> <span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">-</span> <span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">iqr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.01026296615600586
</pre></div>
</div>
</div>
</div>
<p>The last variability metric that we would like to share with you is <strong>Standard Deviation</strong>. This value gives us an idea of, on average, how far are our values from the mean. We can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.std.html">std</a></strong> method to calculate the standard deviation of our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std_dev</span> <span class="o">=</span> <span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">std_dev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>65.37632416317761
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3><strong>Correlation</strong><a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>To graphically understand the relationship between 2 numerical variables, we can use a <strong>scatter plot</strong>. we can use the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.plot.scatter.html">plot.scatter</a></strong> method to create a scatter plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtering orig_bytes &lt; 10000</span>
<span class="n">zeek_df</span><span class="p">[</span><span class="n">zeek_df</span><span class="p">[</span><span class="s1">&#39;orig_bytes&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;orig_bytes&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;resp_bytes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;orig_bytes&#39;, ylabel=&#39;resp_bytes&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/day1-3-Data-Analysis-with-Pandas Intro_217_1.png" src="../../_images/day1-3-Data-Analysis-with-Pandas Intro_217_1.png" />
</div>
</div>
<p>Pandas also provies us with the <strong><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.corr.html">corr</a></strong> method to calculate correlation coeficients (Default method: Pearson coefficient - Linear Relation). We can correlate 2 or more numerical variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_data_updated</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>duration</th>
      <th>orig_bytes</th>
      <th>orig_pkts</th>
      <th>resp_bytes</th>
      <th>resp_pkts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>duration</th>
      <td>1.000000</td>
      <td>0.088359</td>
      <td>0.935223</td>
      <td>0.903869</td>
      <td>0.930104</td>
    </tr>
    <tr>
      <th>orig_bytes</th>
      <td>0.088359</td>
      <td>1.000000</td>
      <td>0.148155</td>
      <td>0.075493</td>
      <td>0.099968</td>
    </tr>
    <tr>
      <th>orig_pkts</th>
      <td>0.935223</td>
      <td>0.148155</td>
      <td>1.000000</td>
      <td>0.980667</td>
      <td>0.997377</td>
    </tr>
    <tr>
      <th>resp_bytes</th>
      <td>0.903869</td>
      <td>0.075493</td>
      <td>0.980667</td>
      <td>1.000000</td>
      <td>0.988010</td>
    </tr>
    <tr>
      <th>resp_pkts</th>
      <td>0.930104</td>
      <td>0.099968</td>
      <td>0.997377</td>
      <td>0.988010</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="end-of-session">
<h1>End of Session<a class="headerlink" href="#end-of-session" title="Permalink to this headline">#</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="font-color-peru-break-5-minutes-font">
<h1><font color=peru>Break: 5 Minutes</font><a class="headerlink" href="#font-color-peru-break-5-minutes-font" title="Permalink to this headline">#</a></h1>
<p><img alt="" src="../../_images/dog-leash-break.jpg" /></p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./workshops\day1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="day1-2-Acquiring-data.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Workshop 1.2: <font color=peru>Acquiring Data</font></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../day2/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Day 2</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Open Threat Research @OTR_Community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>